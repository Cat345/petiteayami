"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Vue.config.devtools=!0,function(g){Vue.component("multiselect",window.VueMultiselect.default),g(document).ready(function(){var n=function(e,t){var a=!1;return"object"===_typeof(e)&&void 0!==t&&(a=Object.prototype.hasOwnProperty.call(e,t)),a},a={headerColor:"#6dbe45",background:"#fff",borderBottom:!1,history:!1,overlayColor:"rgba(0, 0, 0, 0.6)",navigateCaption:!0,navigateArrows:"false",width:680,timeoutProgressbar:!0,radius:10,bottom:"auto",closeButton:!0,pauseOnHover:!1,overlay:!0,transitionIn:"fadeIn"},i={data:{is_initialized:"1"},methods:{openTrafficpop:function(e){g(e).iziModal("close"),self.variant_settings_vue.update_traffics()},decodeHtml:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value},prettyJSON:function(e){if(e)return(e=(e=JSON.stringify(e,void 0,4)).replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="'+t+'">'+e+"</span>"})}}},s=new wp_admin_ajax,e=!1,t=!1;this.experiment_settings_vue=null,this.update_experiment_vue=null,this.variant_settings_vue=null,this.settings_tab_vue=null,this.add_variant_vue=null,this.update_traffic_vue=null,this.check_readiness_vue=null,this.reset_stats_vue=null,this.stop_experiment_vue=null,VueFormGenerator.validators.is_existing=function(e,t){return void 0!==e.existing&&"experiment_control"===t.inputName&&!0===e.existing?[bwfabt.add_experiment.existing]:[]},VueFormGenerator.validators.resources.fieldIsRequired="";self.experiment_settings_vue=new Vue({mixins:[i],el:"#bwfabt_experiments_area",components:{"vue-form-generator":VueFormGenerator.component,Multiselect:window.VueMultiselect.default},data:{modal:!1,model:{experiment_control:"",experiment_name:"",experiment_desc:"",allControls:[]},search_timeout:!1,schema:{fields:function(){var e,t=[{type:"vueMultiSelect",label:"",model:"experiment_control",inputName:"experiment_control",required:!0,validator:["required","is_existing"],selectOptions:{multiSelect:!1,key:"id",label:"name",onSearch:function(e){var t=e;g(".multiselect__tags .multiselect__spinner").show();e=bwfabt.custom_options.not_found;1===g(".multiselect .multiselect__content li").length&&g(".multiselect .multiselect__content").append('<li class="no_found"><span class="multiselect__option">'+e+"</span></li>"),g(".multiselect .multiselect__content li.no_found").hide(),""!==t?(clearTimeout(self.search_timeout),self.search_timeout=setTimeout(function(e){s.ajax("page_search",{term:e,type:self.experiment_settings_vue.experiment_type,_nonce:bwfabtParams.ajax_nonce_page_search}),s.success=function(e){void 0!==e&&!0===e.status?(self.experiment_settings_vue.model.allControls=e.controls,g(".multiselect__tags .multiselect__spinner").hide()):(g(".multiselect .multiselect__content li:not(.multiselect__element)").hide(),g(".multiselect .multiselect__content li.no_found").show())},s.complete=function(){g(".multiselect__tags .multiselect__spinner").hide()}},800,t)):g(".multiselect__tags .multiselect__spinner").hide()}},values:function(){return this.model.allControls}},{type:"input",inputType:"text",label:"",model:"experiment_name",inputName:"experiment_name",featured:!0,required:!0,placeholder:"",validator:["string","required"]},{type:"textArea",label:"",model:"experiment_desc",inputName:"experiment_desc",featured:!0,rows:3,placeholder:""}];for(e in t){var a=t[e].model;g.extend(t[e],bwfabt.add_experiment.label_texts[a])}return t}()},formOptions:{validateAfterLoad:!1,validateAfterChanged:!0},exp_step:bwfabt.add_experiment.exp_step,experiment_type:bwfabt.add_experiment.default_exp_type,control_title:""},methods:{getEntitiesForType:function(){return""===this.experiment_type?(g(".bwfabt-type-error").removeClass("bwfabt-hidden"),void setTimeout(function(){g(".bwfabt-type-error").addClass("bwfabt-hidden")},2e3)):(this.show_loader(),s.ajax("get_experiment_controls",{type:self.experiment_settings_vue.experiment_type,_nonce:bwfabtParams.ajax_nonce_get_experiment_controls}),s.success=function(e){!0===e.status&&(self.experiment_settings_vue.control_title=e.title,self.experiment_settings_vue.move_to_next_step(self.experiment_settings_vue.exp_step))},[])},createExperiment:function(){!1!==this.$refs.vfg.validate()&&(self.experiment_settings_vue.move_to_next_step(self.experiment_settings_vue.exp_step),s.ajax("add_new_experiment",{experiment_control:self.experiment_settings_vue.model.experiment_control.id,experiment_type:self.experiment_settings_vue.experiment_type,experiment_name:self.experiment_settings_vue.model.experiment_name,experiment_desc:self.experiment_settings_vue.model.experiment_desc,_nonce:bwfabtParams.ajax_nonce_add_new_experiment}),s.success=function(e){!0===e.status&&(setTimeout(function(){self.experiment_settings_vue.control_title=e.msg,self.experiment_settings_vue.move_to_next_step(self.experiment_settings_vue.exp_step)},1e3),setTimeout(function(){window.location.href=e.redirect_url},2500))})},show_loader:function(){var e=self.experiment_settings_vue.exp_step;self.experiment_settings_vue.prev_step=e,self.experiment_settings_vue.exp_step=0},move_to_next_step:function(e){0===e&&(e=self.experiment_settings_vue.prev_step),self.experiment_settings_vue.exp_step=parseInt(e)+parseInt(1)},move_to_previous_step:function(e){0===e&&(e=self.experiment_settings_vue.prev_step),self.experiment_settings_vue.exp_step=parseInt(e)-parseInt(1)},set_controller_type:function(e,t){self.experiment_settings_vue.experiment_type=t,g(".bwfabt-type-error").addClass("bwfabt-hidden")}},updated:function(){h()}}),g(".bwfabt-delete-experiment").on("click",function(){var e=g(this).attr("data-experiment-id"),t=g(this);t.addClass("disabled"),0<e&&(g("#modal-delete-experiment").iziModal(g.extend({icon:"icon-check",closeOnEscape:!1,overlayClose:!1},a)),g("#modal-delete-experiment").iziModal("open"),g(".bwfabt_delete_exp").on("click",function(){g(".bwfabt-exp-delete-confirmation").addClass("bwfabt-hide"),g(".bwfabt-experiment-deleting").removeClass("bwfabt-hide"),s.ajax("delete_experiment",{experiment_id:e,_nonce:bwfabtParams.ajax_nonce_delete_experiment}),s.success=function(e){"string"==typeof e&&(e=JSON.parse(e)),!0===e.status?(setTimeout(function(){g(".bwfabt-experiment-deleting").addClass("bwfabt-hide"),g(".bwfabt-experiment-deleted").removeClass("bwfabt-hide")},2e3),setTimeout(function(){g("#modal-delete-experiment").iziModal("close"),location.reload()},4e3)):setTimeout(function(){g("#modal-delete-experiment").iziModal("close"),location.reload()},3e3),t.removeClass("disabled")}}))});!0!==e&&(e=!0,self.variant_settings_vue=new Vue({el:"#bwfabt_common_vue",mixins:[i],components:{"vue-form-generator":VueFormGenerator.component},methods:{getDefaultVariants:function(){var e,t={};for(e in self.variant_settings_vue.variants)0!=self.variant_settings_vue.variants[e].status&&0!=self.variant_settings_vue.variants[e].active&&(t[e]=self.variant_settings_vue.variants[e]);return t},getDefaultVariantsTraffic:function(){var e,t={};for(e in self.variant_settings_vue.variants)0!=self.variant_settings_vue.variants[e].status&&0!=self.variant_settings_vue.variants[e].active&&(t[e]=self.variant_settings_vue.variants[e].traffic);return t},updateExperiment:function(){0<g("#modal-update-experiment").length&&(g("#modal-update-experiment").iziModal(g.extend({closeOnEscape:!1,overlayClose:!1,onOpened:function(e){g(".wfabt_bnt_rem").removeClass("bwfabt-hide"),r(e)},onClosed:function(){self.update_experiment_vue.$destroy(),g("#modal-update-experiment").iziModal("resetContent")}},a)),g("#modal-update-experiment").iziModal("open"))},wfabtHP:function(e,t){return n(e,t)},addVariant:function(){if("2"===self.variant_settings_vue.experiment_status)return!1;0<g("#modal-add-variant").length&&(g("#modal-add-variant").iziModal(g.extend({closeOnEscape:!1,overlayClose:!1,onOpened:function(e){g(".wfabt_bnt_rem").removeClass("bwfabt-hide"),_(e)},onClosed:function(){self.add_variant_vue.$destroy(),g("#modal-add-variant").iziModal("resetContent")}},a)),g("#modal-add-variant").iziModal("open"))},duplicateVariant:function(e){this.CurrentDuplicateVariant=e,0<g("#modal-duplicate-variant").length&&(g("#modal-duplicate-variant").iziModal(g.extend({closeOnEscape:!1,overlayClose:!1,onOpened:function(e){l(e,self.variant_settings_vue.CurrentDuplicateVariant)},onClosed:function(){self.duplicate_variant_vue.$destroy(),g("#modal-duplicate-variant").iziModal("resetContent")}},a)),g("#modal-duplicate-variant").iziModal("open"))},deleteVarntConsent:function(e){this.CurrentDeleteVariant=e,0<g("#modal-delete-variant").length&&(g("#modal-delete-variant").iziModal(g.extend({closeOnEscape:!1,overlayClose:!1,onOpening:function(e){f(e,self.variant_settings_vue.CurrentDeleteVariant)},onClosed:function(){self.delete_variant_vue.$destroy(),g("#modal-delete-variant").iziModal("resetContent")}},a)),g("#modal-delete-variant").iziModal("open"))},draftVariantConsent:function(e){this.CurrentDraftVariant=e,0<g("#modal-draft-variant").length&&(g("#modal-draft-variant").iziModal(g.extend({closeOnEscape:!1,overlayClose:!1,onOpened:function(e){u(e,self.variant_settings_vue.CurrentDraftVariant)},onClosed:function(){self.draft_variant_vue.$destroy(),g("#modal-draft-variant").iziModal("resetContent"),g("#modal-draft-variant").iziModal("destroy")}},a)),g("#modal-draft-variant").iziModal("open"))},publishVariantConsent:function(e){this.CurrentPublishVariant=e,0<g("#modal-publish-variant").length&&(g("#modal-publish-variant").iziModal(g.extend({closeOnEscape:!1,overlayClose:!1,onOpened:function(e){d(e,self.variant_settings_vue.CurrentPublishVariant)},onClosed:function(){self.publish_variant_vue.$destroy(),g("#modal-publish-variant").iziModal("resetContent"),g("#modal-publish-variant").iziModal("destroy")}},a)),g("#modal-publish-variant").iziModal("open"))},startExperiment:function(){if(4===self.variant_settings_vue.experiment_status)return!1;0<g("#modal_start_experiment").length&&g("#modal_start_experiment").iziModal(g.extend({onOpening:function(){p(),s.ajax("check_readiness",{experiment_id:bwfabt.list_variants.experiment_id,_nonce:bwfabtParams.ajax_nonce_check_readiness}),s.success=function(e){!0===e.status?(self.check_readiness_vue.no_variant=e.no_variant,self.check_readiness_vue.InValid_traffic=e.InValid_traffic,self.check_readiness_vue.inactive_variant=e.inactive_variant,self.check_readiness_vue.inactive_error=bwfabt.start_experiment.inactive_error,self.check_readiness_vue.inactive_variants=e.inactive_variants):self.check_readiness_vue.unable_to_start=!0,setTimeout(function(){self.check_readiness_vue.readiness_state=e.readiness_state,self.check_readiness_vue.message=e.message},2e3)}},onClosed:function(){self.check_readiness_vue.$destroy(),g("#modal_start_experiment").iziModal("resetContent"),g("#modal_start_experiment").iziModal("destroy")}},a)),g("#modal_start_experiment").iziModal("open")},stopExperiment:function(){console.log("clicked"),0<g("#modal_stop_experiment").length&&(console.log(g("#modal_stop_experiment").length),g("#modal_stop_experiment").iziModal(g.extend({onOpened:function(e){console.log("clicked on opened"),v(e,self.variant_settings_vue.experiment_id)},onClosed:function(){self.stop_experiment_vue.$destroy(),g("#modal_stop_experiment").iziModal("resetContent")}},a))),g("#modal_stop_experiment").iziModal("open")},update_traffics:function(){0<g("#modal_update_traffic").length&&g("#modal_update_traffic").iziModal(g.extend({closeOnEscape:!1,overlayClose:!1,onOpened:function(e){c(e)},onClosed:function(){self.update_traffic_vue.normalizeTraffic(),self.update_traffic_vue.$destroy(),g("#modal_update_traffic").iziModal("resetContent")}},a)),g("#modal_update_traffic").iziModal("open")},setTrafficCircle:function(){for(var e in this.variants)g('.circle[data-v-id="'+e+'"]').circleProgress({value:this.variants[e].traffic/100,size:21,startAngle:-1.57,fill:{color:"#80c63c"}})},getVariantColor:function(e){var t,a=0;for(t in self.variant_settings_vue.variants_order)if(parseInt(e)===parseInt(self.variant_settings_vue.variants_order[t])){a=t;break}return self.variant_settings_vue.variant_colors[a]},getTotalVariantCount:function(){return Object.keys(this.variants).length},rearragneVariantsOrder:function(){var e,t=[];for(e in this.variants)t.push(e);self.variant_settings_vue.variants_order=t}},schema:{},data:{modal:!1,experiment_id:0,experiment_status:0,control_id:0,variant_id:0,variants:[],update_traffic:[],readiness_state:0,CurrentDeleteVariant:0,CurrentDraftVariant:0,CurrentDuplicateVariant:0,variant_colors:bwfabt.list_variants.colors,variants_order:[],message:""},updated:function(){"variants"===bwfabt.current_exp_section&&this.setTrafficCircle()}}),self.variant_settings_vue.experiment_id=bwfabt.list_variants.experiment_id,self.variant_settings_vue.control_id=bwfabt.list_variants.control_id,self.variant_settings_vue.variants=bwfabt.list_variants.variants,self.variant_settings_vue.variants_order=bwfabt.list_variants.variants_order,self.variant_settings_vue.update_traffic=bwfabt.update_traffic.update_data,self.variant_settings_vue.experiment_status=bwfabt.start_experiment.experiment_status,self.variant_settings_vue.readiness_state=bwfabt.start_experiment.readiness_state,self.variant_settings_vue.message=bwfabt.start_experiment.message);!0!==t&&(t=!0,self.settings_tab_vue=new Vue({el:"#bwfabt_settings_area",mixins:[i],components:{"vue-form-generator":VueFormGenerator.component},data:{modal:!1,experiment_id:0,experiment_status:0,settings_tab:bwfabt.settings_tab.default_tab},methods:{resetStatsConsent:function(){0<g("#modal-reset-stats").length&&(g("#modal-reset-stats").iziModal(g.extend({onOpening:function(e){m(e,self.variant_settings_vue.experiment_id)},onClosed:function(){self.reset_stats_vue.$destroy(),g("#modal-reset-stats").iziModal("resetContent")}},a)),g("#modal-reset-stats").iziModal("open"))},setTab:function(e){self.settings_tab_vue.settings_tab=e}}}),self.settings_tab_vue.experiment_id=bwfabt.list_variants.experiment_id,self.settings_tab_vue.experiment_status=self.variant_settings_vue.experiment_status);var r=function(e){self.update_experiment_vue=new Vue({mixins:[i],components:{"vue-form-generator":VueFormGenerator.component},data:{modal:e,update_status:bwfabt.update_experiment.update_status,model:{experiment_name:"",experiment_desc:""},state:1,schema:{fields:function(){var e,t=[{type:"input",inputType:"text",label:"",model:"experiment_name",inputName:"experiment_name",featured:!0,required:!0,placeholder:"",validator:VueFormGenerator.validators.string},{type:"textArea",label:"",model:"experiment_desc",inputName:"experiment_desc",featured:!0,rows:3,placeholder:""}];for(e in t){var a=t[e].model;g.extend(t[e],bwfabt.update_experiment.label_texts[a])}return t}()},formOptions:{validateAfterLoad:!1,validateAfterChanged:!0},experiment_name:bwfabt.update_experiment.label_texts.experiment_name.value,experiment_desc:bwfabt.update_experiment.label_texts.experiment_desc.value},methods:{updateExperiment:function(){!1!==this.$refs.update_experiment_ref.validate()&&(self.update_experiment_vue.update_status="updating",s.ajax("update_experiment",{experiment_id:bwfabt.list_variants.experiment_id,experiment_name:self.update_experiment_vue.model.experiment_name,experiment_desc:self.update_experiment_vue.model.experiment_desc,_nonce:bwfabtParams.ajax_nonce_update_experiment}),s.success=function(e){!0===e.status&&(setTimeout(function(){var e=g("#bwfabt_common_vue .bwf_breadcrumb ul li:last-child span.wfabt_status_btn").text();g("#bwfabt_common_vue .bwf_breadcrumb ul li:last-child").html(self.update_experiment_vue.model.experiment_name+' <span class="wfabt_status_btn">'+e+"</span>")},2e3),self.update_experiment_vue.experiment_name=self.update_experiment_vue.model.experiment_name,self.update_experiment_vue.experiment_desc=self.update_experiment_vue.model.experiment_desc),setTimeout(function(){self.update_experiment_vue.update_status="updated"},2e3),setTimeout(function(){g("#modal-update-experiment").iziModal("close")},4e3)})}},mounted:function(){this.model.experiment_name=void 0===self.update_experiment_vue?bwfabt.update_experiment.label_texts.experiment_name.value:self.update_experiment_vue.experiment_name,this.model.experiment_desc=void 0===self.update_experiment_vue?bwfabt.update_experiment.label_texts.experiment_desc.value:self.update_experiment_vue.experiment_desc}}).$mount("#part_update_experiment_vue")};var o,_=function(e){self.add_variant_vue=new Vue({mixins:[i],components:{"vue-form-generator":VueFormGenerator.component},data:{modal:e,model:{variant_title:"",variant_desc:""},schema:{fields:function(){var e,t=[{type:"input",inputType:"text",label:"",model:"variant_title",inputName:"variant_title",featured:!0,required:!0,placeholder:"",validator:VueFormGenerator.validators.string},{type:"textArea",label:"",model:"variant_desc",inputName:"variant_desc",featured:!0,rows:3,placeholder:""}];for(e in t){var a=t[e].model;g.extend(t[e],bwfabt.add_variant.label_texts[a])}return t}()},formOptions:{validateAfterLoad:!1,validateAfterChanged:!0},experiment_id:0,state:1},methods:{create_variant:function(){!1!==this.$refs.add_variant_ref.validate()&&(self.add_variant_vue.state=2,s.ajax("add_variant",{experiment_id:self.add_variant_vue.experiment_id,variant_title:self.add_variant_vue.model.variant_title,variant_desc:self.add_variant_vue.model.variant_desc,_nonce:bwfabtParams.ajax_nonce_add_variant}),s.success=function(e){!0===e.status?(Vue.set(self.variant_settings_vue.variants,e.id,e.data),Vue.set(self.variant_settings_vue.variants_order,e.variant_order,e.id),self.add_variant_vue.state=3):(g(".bwfabt_disp_none .bwfabt_text_center").html('<div class="wfabt_h3">'+e.msg+"</div>"),setTimeout(function(){g("#modal-add-variant").iziModal("close")},2e3))})}}}).$mount("#part_add_variant_vue"),self.add_variant_vue.experiment_id=bwfabt.list_variants.experiment_id},l=function(e,t){self.duplicate_variant_vue=new Vue({mixins:[i],components:{},data:{myvar:"4444",modal:e,model:{},experiment_id:0,duplicate_status:bwfabt.duplicate_variant.duplicate_status},methods:{duplicateVariant:function(e){s.ajax("duplicate_variant",{experiment_id:self.variant_settings_vue.experiment_id,variant_id:e,_nonce:bwfabtParams.ajax_nonce_duplicate_variant}),s.success=function(e){"string"==typeof e&&(e=JSON.parse(e)),!0===e.status?(self.duplicate_variant_vue.duplicate_status="duplicated",Vue.set(self.variant_settings_vue.variants,e.duplicated_variant_id,e.data),Vue.set(self.variant_settings_vue.variants_order,e.variant_order,e.duplicated_variant_id)):(g("#part_duplicate_variant_vue .bwfabt_text_center").html('<div class="wfabt_h3">'+e.msg+"</div>"),setTimeout(function(){g("#modal-duplicate-variant").iziModal("close")},2e3))}}},mounted:function(){this.duplicateVariant(t)}}).$mount("#part_duplicate_variant_vue"),self.duplicate_variant_vue.experiment_id=bwfabt.list_variants.experiment_id},u=function(e,a){self.draft_variant_vue=new Vue({mixins:[i],components:{},data:{modal:e,model:{},experiment_id:0,state:1,remove_status:"remove",error:"",message:""},methods:{draftVariant:function(){var e=self.variant_settings_vue.experiment_id;Vue.set(self.draft_variant_vue,"remove_status","removing"),s.ajax("draft_variant",{experiment_id:e,variant_id:a,_nonce:bwfabtParams.ajax_nonce_draft_variant}),s.success=function(e){var t;"string"==typeof e&&(e=JSON.parse(e)),!0===e.status?(setTimeout(function(){Vue.set(self.draft_variant_vue,"remove_status","removed"),Vue.set(self.draft_variant_vue,"error",e.error),Vue.set(self.draft_variant_vue,"message",e.message)},3e3),t=self.variant_settings_vue.variants[a],Vue.set(self.variant_settings_vue.variants,a,t),Vue.set(self.variant_settings_vue.variants[a],"active",!1),t=self.variant_settings_vue.variants[a].row_actions.draft,Vue.set(self.variant_settings_vue.variants[a].row_actions,"draft",{}),Vue.set(self.variant_settings_vue.variants[a].row_actions,"publish",t),Vue.set(self.variant_settings_vue.variants[a].row_actions.publish,"text",bwfabt.variant_text.publish),Vue.set(self.variant_settings_vue.variants[a],"traffic","0.00")):setTimeout(function(){Vue.set(self.draft_variant_vue,"remove_status","remove_error"),Vue.set(self.draft_variant_vue,"error",e.error),Vue.set(self.draft_variant_vue,"message",e.message)},3e3)}}}}).$mount("#part_draft_variant_vue"),self.draft_variant_vue.experiment_id=bwfabt.list_variants.experiment_id},d=function(e,t){self.publish_variant_vue=new Vue({mixins:[i],components:{},data:{modal:e,model:{},experiment_id:0,state:1,publish_status:"publish"},methods:{publishVariant:function(){var e=self.variant_settings_vue.experiment_id;Vue.set(self.publish_variant_vue,"publish_status","publishing"),s.ajax("publish_variant",{experiment_id:e,variant_id:t,_nonce:bwfabtParams.ajax_nonce_publish_variant}),s.success=function(e){"string"==typeof e&&(e=JSON.parse(e)),!0===e.status?setTimeout(function(){Vue.set(self.publish_variant_vue,"publish_status","published"),Vue.set(self.variant_settings_vue.variants[t],"active",!0);var e=self.variant_settings_vue.variants[t].row_actions.publish;Vue.set(self.variant_settings_vue.variants[t].row_actions,"publish",{}),Vue.set(self.variant_settings_vue.variants[t].row_actions,"draft",e),Vue.set(self.variant_settings_vue.variants[t].row_actions.draft,"text",bwfabt.variant_text.draft)},3e3):setTimeout(function(){Vue.set(self.publish_variant_vue,"publish_status","publish_error")},3e3)}}}}).$mount("#part_publish_variant_vue"),self.publish_variant_vue.experiment_id=bwfabt.list_variants.experiment_id},f=function(e,t){self.delete_variant_vue=new Vue({mixins:[i],components:{},data:{modal:e,model:{},experiment_id:0,variantID:t,state:1,control_only:!1,delete_status:bwfabt.delete_variant.delete_status},methods:{deleteVariant:function(){self.delete_variant_vue.delete_status="deleting",s.ajax("delete_variant",{experiment_id:self.variant_settings_vue.experiment_id,variant_id:t,_nonce:bwfabtParams.ajax_nonce_delete_variant}),s.success=function(e){"string"==typeof e&&(e=JSON.parse(e)),!0===e.status&&setTimeout(function(){self.delete_variant_vue.delete_status="deleted",self.delete_variant_vue.control_only=e.control_only,Vue.delete(self.variant_settings_vue.variants,t),self.variant_settings_vue.rearragneVariantsOrder(),e.control_only&&(Vue.set(self.variant_settings_vue.variants[e.control_id],"traffic","100.00"),setTimeout(function(){g("#modal-delete-variant").iziModal("close")},2e3))},200)}}}}).$mount("#part_delete_variant_vue"),self.delete_variant_vue.experiment_id=bwfabt.list_variants.experiment_id},c=function(e){self.update_traffic_vue=new Vue({mixins:[i],components:{"vue-form-generator":VueFormGenerator.component},data:{modal:e,schema:{},variants:self.variant_settings_vue.getDefaultVariants(),update_traffic:self.variant_settings_vue.update_traffic,trafficRestore:self.variant_settings_vue.getDefaultVariantsTraffic(),variant_id:0,experiment_id:self.variant_settings_vue.experiment_id,state:1},methods:{set_equal_traffic:function(){var e=this.getTotalVariantCount();if(0<e){var t,a=Math.trunc(100/e),n=0,i=0;for(t in a*e<100&&(i=100-a*e,console.log(self.update_traffic_vue.variants)),self.update_traffic_vue.variants)!0===self.update_traffic_vue.variants[t].control?self.update_traffic_vue.variants[t].traffic=(a+i).toFixed(2):self.update_traffic_vue.variants[t].traffic=a.toFixed(2),n=parseFloat(n)+parseFloat(self.update_traffic_vue.variants[t].traffic);this.update_traffic.total_trf_value=n,this.update_traffic.InValid_traffic=!1}return!1},update_variant_traffic:function(){var e,t=0;for(e in self.update_traffic_vue.variants)t=parseFloat(t)+parseFloat(self.update_traffic_vue.variants[e].traffic);if(100!==(this.update_traffic.total_trf_value=t))return alert(bwfabt.update_traffic.update_data.traffic_error),!(this.update_traffic.InValid_traffic=2);var a,n=[];for(a in self.update_traffic_vue.variants)n.push({variant_id:a,traffic:self.update_traffic_vue.variants[a].traffic}),this.trafficRestore[a]=self.update_traffic_vue.variants[a].traffic;this.update_traffic.InValid_traffic=!1,self.update_traffic_vue.state=2,s.ajax("update_traffic",{experiment_id:self.update_traffic_vue.experiment_id,traffics:n,_nonce:bwfabtParams.ajax_nonce_update_traffic}),s.success=function(e){"string"==typeof e&&(e=JSON.parse(e)),!0===e.status?(setTimeout(function(){self.update_traffic_vue.state=3},2e3),setTimeout(function(){g("#modal_update_traffic").iziModal("close"),location.reload()},4e3)):g(".bwfabt-update-traffic-resposne").html(e.msg)}},controlTraffic:function(e,t){t=t.target.value;0<e&&(t=99.99<(t=""===t||void 0===t?0:t)?100:t,self.update_traffic_vue.variants[e].traffic=t)},fixTraffic:function(e,t){t=t.target.value;0<e&&(t=99.99<(t=""===t||void 0===t?parseFloat(0):parseFloat(t))?100:t,self.update_traffic_vue.variants[e].traffic=t.toFixed(2))},calculate_traffic:function(){var e,t=0,a=!1;for(e in this.variants)0==this.variants[e].traffic&&(a=!0),t=parseFloat(t)+parseFloat(this.variants[e].traffic);this.update_traffic.total_trf_value=t.toFixed(2),100!==t?Vue.set(this.update_traffic,"InValid_traffic",2):!0===a?Vue.set(this.update_traffic,"InValid_traffic",1):Vue.set(this.update_traffic,"InValid_traffic",!1)},getVariantColor:function(e){return self.variant_settings_vue.getVariantColor(e)},getTotalVariantCount:function(){return Object.keys(this.variants).length},close_update_traffic:function(){g("#modal_update_traffic").iziModal("close")},normalizeTraffic:function(){for(var e in this.trafficRestore)self.update_traffic_vue.variants[e].traffic=this.trafficRestore[e]}},updated:function(){this.calculate_traffic()},mounted:function(){this.calculate_traffic()}}).$mount("#modal_update_traffic_vue")},p=function(){self.check_readiness_vue=new Vue({mixins:[i],components:{"vue-form-generator":VueFormGenerator.component},data:{modal:!1,schema:{},experiment_id:0,readiness_state:0,no_variant:!1,InValid_traffic:!1,inactive_variant:!1,unable_to_start:!1,starting_text:"",message:""},methods:{closeReadiness:function(){g("#modal_start_experiment").iziModal("resetContent"),g("#modal_start_experiment").iziModal("close")},goLive:function(){self.check_readiness_vue.readiness_state=1,self.check_readiness_vue.starting_text=bwfabt.start_experiment.starting;var e=self.variant_settings_vue.experiment_status,t=self.variant_settings_vue.experiment_id;s.ajax("start_experiment",{experiment_id:t,status:e,_nonce:bwfabtParams.ajax_nonce_start_experiment}),s.success=function(e){"string"==typeof e&&(e=JSON.parse(e)),!0===e.status?(setTimeout(function(){self.check_readiness_vue.readiness_state=4},2e3),setTimeout(function(){location.reload()},4e3)):setTimeout(function(){self.check_readiness_vue.unable_to_start=!0,self.check_readiness_vue.readiness_state=2},5e3)}}}}).$mount("#bwfabt-readiness-vue"),self.check_readiness_vue.readiness_state=self.variant_settings_vue.readiness_state},m=function(e,t){self.reset_stats_vue=new Vue({mixins:[i],components:{},data:{modal:e,model:{},experiment_id:0,reset_status:bwfabt.reset_stats.reset_status,experiment_status:""},methods:{resetStats:function(){self.reset_stats_vue.reset_status="resetting",s.ajax("reset_stats",{experiment_id:t,_nonce:bwfabtParams.ajax_nonce_reset_stats}),s.success=function(e){"string"==typeof e&&(e=JSON.parse(e)),!0===e.status&&(setTimeout(function(){self.reset_stats_vue.reset_status="reset_complete"},2e3),setTimeout(function(){window.location=e.redirect_url,g("#modal-reset-stats").iziModal("close")},4e3))}}}}).$mount("#part_reset_stats_vue"),self.reset_stats_vue.experiment_id=bwfabt.list_variants.experiment_id,self.reset_stats_vue.experiment_status=self.variant_settings_vue.experiment_status},v=function(e,t){self.stop_experiment_vue=new Vue({mixins:[i],components:{},data:{modal:e,model:{},experiment_id:0,stop_status:bwfabt.stop_experiment.stop_status},methods:{stoppingExperiment:function(){console.log("clicked on stopping"),s.ajax("stop_experiment",{experiment_id:t,_nonce:bwfabtParams.ajax_nonce_stop_experiment}),s.success=function(e){"string"==typeof e&&(e=JSON.parse(e)),!0===e.status&&(setTimeout(function(){self.stop_experiment_vue.stop_status="paused"},2e3),setTimeout(function(){location.reload(),g("#modal_stop_experiment").iziModal("close")},4e3))}}},mounted:function(){console.log("clicked on mounted"),this.stoppingExperiment()}}).$mount("#part_stop_experiment_vue"),self.stop_experiment_vue.experiment_id=bwfabt.list_variants.experiment_id};function b(e,t,a){var n,i,s=document.getElementById("bwfabt_chart").getContext("2d"),r=[],o=[],_=[],l=t,u=e;for(n in 1===bwfabtChart.dates[l].length&&o.push("0"),bwfabtChart.dates[l])o.push(bwfabtChart.dates[l][n]);for(i in 1===bwfabtChart.dates[l].length&&o.push("0"),bwfabtChart.variant_title){for(var d in _=[],1===bwfabtChart.dates[l].length&&_.push(NaN),bwfabtChart.dates[l])_.push(bwfabtChart[u][l][i][bwfabtChart.dates[l][d]]);1===bwfabtChart.dates[l].length&&_.push(NaN),r.push({data:_,label:self.variant_settings_vue.decodeHtml(bwfabtChart.variant_title[i]),borderColor:bwfabtChart.variant_colors[i],backgroundColor:bwfabtChart.variant_colors[i],fill:!1,lineTension:.4})}return void 0===a?a=new Chart(s,{type:"line",data:{labels:o,datasets:r},options:x(e,t)}):(a.data.labels=o,a.data.datasets=r,a.options=x(e,t),a.update()),a}function x(e,t){var a=bwfabtChart.defaults.options;return n(a,"scales")&&n(a.scales,"xAxes")&&n(a.scales.xAxes[0],"scaleLabel")&&n(a.scales.xAxes[0].scaleLabel,"labelString")&&(a.scales.xAxes[0].scaleLabel.labelString=bwfabtChart.chart_frequencies_chart_labels[t]),n(a,"scales")&&n(a.scales,"yAxes")&&n(a.scales.yAxes[0],"scaleLabel")&&n(a.scales.yAxes[0].scaleLabel,"labelString")&&(a.scales.yAxes[0].scaleLabel.labelString=bwfabtChart.stats_head_chart_labels[e]),a}function h(){0<g(".wfabt_new_expr_sec").length&&g(".wfabt_new_expr_sec").hasClass("bwfabt_hide")&&g(".wfabt_new_expr_sec").removeClass("bwfabt_hide"),0<g(".wfabt_first_experiment_box").length&&g(".wfabt_first_experiment_box").hasClass("bwfabt_hide")&&g(".wfabt_first_experiment_box").removeClass("bwfabt_hide")}g(".accordionItemHeading").on("click",function(){var e=g(this).parents(".accordionItem").eq(0);!0===e.hasClass("close")?(e.addClass("open"),e.removeClass("close")):(e.addClass("close"),e.removeClass("open"))}),0<g("#modal_choose_winner").length&&g("#modal_choose_winner").iziModal({padding:0,width:680,timeoutProgressbar:!0,radius:10,bottom:"auto",closeButton:!1,pauseOnHover:!1,overlay:!0,onOpened:function(){var t,e=0,a=0;g(".close_p.wfabt_btn").on("click",function(){g("#modal_choose_winner").iziModal("resetContent"),g("#modal_choose_winner").iziModal("close")}),g(".choose_ab_winner").on("click",function(){g(".choose_ab_winner").removeClass("wfabt_bg_act"),g(this).addClass("wfabt_bg_act"),e=g(this).attr("data-funnel_id"),a=g(".wfabt_make_winner").attr("data-experiment_id"),g(".wfabt_make_winner").removeClass("wfab_winner_disabled"),g(".wfabt_make_winner_help").hide()}),g(".wfabt_make_winner").on("click",function(){g(this).hasClass("wfab_winner_disabled")||(0<e&&(t=bwfabt.list_variants.variants[e].title,g("#choose_winner").addClass("bwfabt-hide"),g("#confirm_winner").removeClass("bwfabt-hide"),g(".winner-name").html(t)),g(".winner_error").removeClass("bwfabt-hide"),setTimeout(function(){g(".winner_error").addClass("bwfabt-hide")},2e3))}),g(".wfabt_make_confirm.wfabt_btn").on("click",function(){return g("#confirm_winner").addClass("bwfabt-hide"),g("#choosing_winner").removeClass("bwfabt-hide"),a<1||e<1?(setTimeout(function(){g("#choosing_winner").addClass("bwfabt-hide"),g("#winner_not_selected").removeClass("bwfabt-hide")},2e3),!1):(s.ajax("choose_winner",{experiment_id:a,winner:e,_nonce:bwfabtParams.ajax_nonce_choose_winner}),void(s.success=function(e){"string"==typeof e&&(e=JSON.parse(e)),!0===e.status?(setTimeout(function(){g("#choosing_winner").addClass("bwfabt-hide"),g("#real_winner").removeClass("bwfabt-hide"),g("#real_winner").find(".deleclared-winner").html(t)},2e3),setTimeout(function(){location.reload()},5e3)):setTimeout(function(){g("#choosing_winner").addClass("bwfabt-hide"),g("#winner_not_selected").removeClass("bwfabt-hide")},3e3)}))})}}),0<g("#bwfabt_chart").length&&(o=b(bwfabtChart.defaults.stats,bwfabtChart.defaults.frequency),g(".bwfabt-params").on("change",function(){var e=g("#bwfabt_frequency").val();b(g("#bwfabt_stats").val(),e,o)})),"complete"==document.readyState?0<g(".bwfabt-loader").length&&g(".bwfabt-loader").each(function(){var e=g(this);e.is(":visible")&&setTimeout(function(e){e.remove()},400,e)}):g(window).bind("load",function(){0<g(".bwfabt-loader").length&&g(".bwfabt-loader").each(function(){var e=g(this);e.is(":visible")&&setTimeout(function(e){e.remove()},400,e)})}),0<g("#e-admin-top-bar-root").length&&g("#e-admin-top-bar-root").addClass("e-admin-top-bar--inactive"),h()})}(jQuery);