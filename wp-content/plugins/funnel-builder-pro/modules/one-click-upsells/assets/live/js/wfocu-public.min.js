"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var wfocuCommons={hooks:{action:{},filter:{}},addAction:function(t,e,i,a){this.addHook("action",t,e,i,a)},addFilter:function(t,e,i,a){this.addHook("filter",t,e,i,a)},doAction:function(t){this.doHook("action",t,arguments)},applyFilters:function(t){return this.doHook("filter",t,arguments)},removeAction:function(t,e){this.removeHook("action",t,e)},removeFilter:function(t,e,i){this.removeHook("filter",t,e,i)},addHook:function(t,e,i,a,s){null==this.hooks[t][e]&&(this.hooks[t][e]=[]);var o=this.hooks[t][e];null==s&&(s=e+"_"+o.length),null==a&&(a=10),this.hooks[t][e].push({tag:s,callable:i,priority:a})},doHook:function(t,e,i){if(i=Array.prototype.slice.call(i,1),null!=this.hooks[t][e]){var a,s=this.hooks[t][e];s.sort(function(t,e){return t.priority-e.priority});for(var o=0;o<s.length;o++)"function"!=typeof(a=s[o].callable)&&(a=window[a]),"action"==t?a.apply(null,i):i[0]=a.apply(null,i)}if("filter"==t)return i[0]},removeHook:function(t,e,i,a){if(null!=this.hooks[t][e])for(var s=this.hooks[t][e],o=s.length-1;0<=o;o--)null!=a&&a!=s[o].tag||null!=i&&i!=s[o].priority||s.splice(o,1)},parseURL:function(t){var e,i,a,s=document.createElement("a"),o={};for(s.href=t,e=s.search.replace(/^\?/,"").split("&"),a=0;a<e.length;a++)o[(i=e[a].split("="))[0]]=i[1];return{protocol:s.protocol,host:s.host,hostname:s.hostname,port:s.port,pathname:s.pathname,search:s.search,searchObject:o,hash:s.hash}},wfab_deparam1:function(t){for(var e=t.split("&"),i={},a=0;a<e.length;a++){var s=e[a].split("="),o=decodeURIComponent(s[0]),n=decodeURIComponent(s[1]),s=o.match(/(^[^\[]+)(\[.*\]$)?/),o=s[1];(s=s[2]?s[2].match(/(?=\[(.*)\]$)/)[1].split("]["):[]).unshift(o),function(t,e,i){var a;1<e.length?(void 0===t[a=e.shift()]&&(t[a]=""==e[0]?[]:{}),arguments.callee(t[a],e,i)):t instanceof Array?t.push(i):t[e]=i}(i,s,n)}return i}};!function(g){var w={ViewsRegistered:!1,items:[],itemsData:[],itemsPrices:[],itemQty:[],itemsTaxes:[],itemsDataDisplay:[],shippingCost:0,shippingOptions:[],shippingPreference:null,ShippingRaw:[],globalVars:window.wfocu_vars,ShippingFlatApplied:{},ShippingCall:null,shippingTax:0,inOfferTransaction:!1,inOfferTransactionData:{},sendStatus:!1,isSending:!1,HasEventRunning:!1,successMessage:'<svg style="margin:12px auto 0;" xmlns="http://www.w3.org/2000/svg" width="121" height="120" viewBox="0 0 121 120" fill="none">\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M60.5 110C88.1142 110 110.5 87.6142 110.5 60C110.5 32.3858 88.1142 10 60.5 10C32.8858 10 10.5 32.3858 10.5 60C10.5 87.6142 32.8858 110 60.5 110ZM89.4291 39.5088C91.5987 41.6732 91.5987 45.1822 89.4291 47.3466L56.0958 80.5992C53.9262 82.7635 50.4086 82.7635 48.239 80.5992L31.5723 63.9729C29.4028 61.8085 29.4028 58.2995 31.5723 56.1352C33.7419 53.9708 37.2595 53.9708 39.4291 56.1352L52.1674 68.8426L81.5723 39.5088C85.0963 36.3741 88.2785 38.2027 89.4291 39.5088Z" fill="#09B29C"/>\n            </svg><div style="color:#353030;font-size:18px;line-height:28px;margin:10px 0 24px;font-weight:500;">'.concat(wfocu_vars.messages.offer_success_message_pop,"</div>"),warningMessage:'<svg style="margin:12px auto 0;" xmlns="http://www.w3.org/2000/svg" width="121" height="120" viewBox="0 0 121 120" fill="none">\n\t\t\t<path d="M60.5078 10C88.1263 10 110.516 32.3892 110.516 60.0078C110.516 87.6263 88.1263 110.015 60.5078 110.015C32.8892 110.015 10.5 87.6263 10.5 60.0078C10.5 32.3892 32.8892 10 60.5078 10ZM60.5078 17.5C37.0314 17.5 18 36.5314 18 60.0078C18 83.4841 37.0314 102.515 60.5078 102.515C83.9841 102.515 103.016 83.4841 103.016 60.0078C103.016 36.5314 83.9841 17.5 60.5078 17.5ZM60.4895 52.5029C62.388 52.5017 63.9579 53.9114 64.2074 55.7416L64.242 56.2505L64.26 83.7584C64.2613 85.8295 62.5835 87.5095 60.5124 87.5109C58.614 87.5121 57.0441 86.1024 56.7946 84.2722L56.76 83.7633L56.742 56.2554C56.7406 54.1843 58.4185 52.5043 60.4895 52.5029ZM60.51 35.0141C63.2677 35.0141 65.5033 37.2497 65.5033 40.0074C65.5033 42.7651 63.2677 45.0007 60.51 45.0007C57.7523 45.0007 55.5167 42.7651 55.5167 40.0074C55.5167 37.2497 57.7523 35.0141 60.51 35.0141Z" fill="#E15334"/>\n\t\t\t</svg><div style="color:#353030;font-size:18px;line-height:28px;margin:10px 0 24px;font-weight:500;">'.concat(wfocu_vars.messages.offer_msg_pop_failure,"</div>"),addItem:function(t,e,i,a,s){void 0===i&&(i=[]),this.items.push(t),!1===a?this.itemsTaxes.push(this.getTaxInfo(t)*s):this.itemsTaxes.push(a*s),this.itemsData.push(i),this.itemQty.push(s),e*=s,w.doShow()&&this.itemsDataDisplay.push(this.prepareDisplay(i,t)),this.needsDynamicShipping(t)?(this.resetShipping(),this.processShipping()):this.needsFlatShipping(t)&&(this.resetShipping(),this.applyFlatShipping()),this.itemsPrices.push(e)},validateBeforeAddItem:function(t,e,i){var a;if(""===i){if(void 0===this.globalVars.offer_data.products[t])return!1;if("variable"===this.globalVars.offer_data.products[t].type)return!1;if(!0===this.globalVars.offer_data.products[t].backorders_allowed)return!0;if(-1===(s=parseInt(this.globalVars.offer_data.products[t].max_qty)))return!0;if(a=parseInt(this.globalVars.offer_data.products[t].quantity),s<this.getQuantity(t)+a)return!1}else{if(void 0===this.globalVars.offer_data.products[t])return!1;var s,o=g('.wfocu_variation_selector_wrap[data-key="'+t+'"]').attr("data-variations-stock");if(-1===(s=JSON.parse(o)[i]))return!0;if(null===s)return!0;if(s=parseInt(s),a=parseInt(this.globalVars.offer_data.products[t].quantity),s<this.getQuantity(t,i)+a)return!1}return!0},getQuantity:function(t,e){var i=0;if(void 0===e)for(var a in o=this.getItems())o[a]===t&&i++;else{var s,o,n=this.getItemsData();for(s in o=this.getItems())if(o[s]===t)for(var r in n[s]){var c=n[s][r];/_wfocu_variation=/i.test(c)&&e===c.slice(17,c.length)&&i++}}return parseInt(this.globalVars.offer_data.products[t].quantity)*i},getItemDataByIndex:function(t,i){var t=this.itemsData[t],a="";return g.each(t,function(t,e){e=e.split("=");i===e[0]&&(a=e[1])}),a},DisableButtonState:function(t){var e=g(".wfocu_upsell");void 0!==t&&(e=g('.wfocu_upsell[data-key="'+t+'"]')),e.addClass("disabled")},EnableButtonState:function(t){var e=g(".wfocu_upsell");void 0!==t&&(e=g('.wfocu_upsell[data-key="'+t+'"]')),e.removeClass("disabled")},removeItem:function(t){var e=this.items[t];this.items.splice(t,1),this.itemsData.splice(t,1),this.itemsTaxes.splice(t,1),this.itemsDataDisplay.splice(t,1),this.itemQty.splice(t,1),this.itemsPrices.splice(t,1),this.needsDynamicShipping(e)?(this.resetShipping(),this.processShipping()):this.needsFlatShipping(e)&&(this.resetShipping(),this.applyFlatShipping())},clean:function(){this.items=[],this.itemsData=[],this.itemsPrices=[],this.itemsTaxes=[],this.itemsDataDisplay=[],this.itemQty=[],this.shippingCost=0,this.shippingOptions=[],this.ShippingRaw=[],this.ShippingFlatApplied={},this.shippingTax=0},getItems:function(){return this.items},getItemsData:function(){return this.itemsData},getItemsPrices:function(){return this.itemsPrices},getItemsQty:function(t){return parseInt(this.globalVars.offer_data.products[t].quantity)},getItemsDataDislay:function(){return this.itemsDataDisplay},getItemDisplayPrice:function(t){var e=this.itemsPrices[t],t=this.itemsTaxes[t];return!0===this.globalVars.global.include_taxes&&!0===this.globalVars.offer_data.is_show_confirmation?e:e+t},getItemDisplayQuantity:function(t,e){return parseInt(this.globalVars.offer_data.products[t].quantity)*parseInt(this.itemQty[e])},getSubtotalPrice:function(){var t=this.sum(this.getItemsPrices()),e=this.sum(this.itemsTaxes);return!0===this.globalVars.global.include_taxes&&!0===this.globalVars.offer_data.is_show_confirmation?t:t+e},MaybeAddShipping:function(t,e,i){if(""===i){var a,s=this.getShippingByKey(t);if(!1===s)return;if(!1===w.isEmpty(s.shipping))for(var o in w.ShippingRaw.push(s.shipping),s.shipping)!1!==(a=w.getShippingDifference(s.shipping[o],s.shipping_prev))&&w.shippingOptions.push({label:w.getShippingLabel(s.shipping[o]),value:o,diff:a,selected:""});else if(!1===w.isEmpty(s.free_shipping))for(var n in w.ShippingRaw.push(s.free_shipping),s.free_shipping)a=w.getShippingDifference(s.free_shipping[n],s.shipping_prev),!0===w.isFloatOrNum(a)&&w.shippingOptions.push({label:w.getShippingLabel(s.free_shipping[n]),value:n,diff:a,selected:""})}else _.has(m.shippingCharges,i)&&w.shippingOptions.push({label:m.shippingCharges[i].label,value:m.shippingCharges[i].method,diff:{cost:m.shippingCharges[i].cost,tax:m.shippingCharges[i].tax},selected:""});0<w.shippingOptions.length&&(w.shippingOptions[0].selected="checked",w.setShipping(parseFloat(w.shippingOptions[0].diff.cost)),w.setShippingTax(parseFloat(w.shippingOptions[0].diff.tax)))},getShippingByKey:function(t){return void 0!==this.globalVars.offer_data.products[t]&&(void 0!==this.globalVars.offer_data.products[t].shipping&&this.globalVars.offer_data.products[t].shipping)},applyFlatShipping:function(){var t,e=[],i=[],a=[];for(t in this.items)this.globalVars.offer_data.products[this.items[t]].needs_shipping&&"flat"===this.shippingPreference&&0<this.globalVars.offer_data.products[this.items[t]].shipping_cost_flat&&-1===a.indexOf(this.items[t])&&(e.push(this.globalVars.offer_data.products[this.items[t]].shipping_cost_flat),i.push(this.globalVars.offer_data.products[this.items[t]].shipping_cost_flat_tax),a.push(this.items[t]));0<a.length&&(w.shippingOptions.push({label:w.globalVars.global.flat_shipping_label,value:"fixed",diff:{cost:this.sum(e),tax:this.sum(i)},selected:""}),w.shippingOptions[0].selected="checked",w.setShipping(parseFloat(w.shippingOptions[0].diff.cost)),w.setShippingTax(parseFloat(w.shippingOptions[0].diff.tax)))},getShippingFlatByKey:function(t){return void 0!==this.globalVars.offer_data.products[t]&&(void 0!==this.globalVars.offer_data.products[t].shipping_cost_flat&&{cost:this.globalVars.offer_data.products[t].shipping_cost_flat,tax:this.globalVars.offer_data.products[t].shipping_cost_flat_tax})},resetShipping:function(){this.shippingCost=0,this.ShippingRaw=[],this.shippingOptions=[]},prepareDisplay:function(t,a){if(0===t.length)return t;var s=[];return g.each(t,function(t,e){var i=e.split("=");"_"!==i[0].charAt(0)&&-1===g.inArray(i[0],window.wfocu_vars.exclude_fields)&&(e=i[1].replace(/\+/g," "),e=m.OptionsHtml[a][i[0]][e],_.isUndefined(e)||s.push({title:w.getDataTitle(i[0]),val:e.innerText}))}),s},getTaxInfo:function(t){return void 0===this.globalVars.offer_data.products[t]||void 0===this.globalVars.offer_data.products[t].tax?0:this.globalVars.offer_data.products[t].tax},needsFlatShipping:function(t){return!1===this.globalVars.is_free_shipping&&!0===this.globalVars.offer_data.products[t].needs_shipping&&"flat"===this.globalVars.offer_data.shipping_preferece},needsDynamicShipping:function(t){return!1===this.globalVars.is_free_shipping&&!0===this.globalVars.offer_data.products[t].needs_shipping&&"dynamic"===this.globalVars.offer_data.shipping_preferece},getItemsNeedDynamicShipping:function(){var i=[];return g(this.getItems()).each(function(t,e){w.needsDynamicShipping(e)&&i.push(e)}),i},processShipping:function(){var t=this.getItemsNeedDynamicShipping();0!==t.length?this.ShippingCall=g.ajax({type:"POST",url:this.globalVars.wc_ajax_url.toString().replace("%%endpoint%%","wfocu_front_calculate_shipping"),data:{action:"wfocu_front_calculate_shipping",nonce:this.globalVars.nonces.wfocu_calculate_shipping,"wfocu-si":this.globalVars.session_id,items:t,itemsData:this.getItemsData()},beforeSend:function(){w.initiateLoader(),null!==w.ShippingCall&&w.ShippingCall.abort()},success:function(t){var e;if(w.clearLoader(),_.has(t,"success")){var i=!1;void 0!==t.data.override&&(i=t.data.override);var a=[];if(!1===w.isEmpty(t.data.free_shipping))for(var s in w.ShippingRaw.push(t.data.free_shipping),t.data.free_shipping)!1!==(e=w.getShippingDifference(t.data.free_shipping[s],t.data.shipping_prev))&&(a.push(s),w.shippingOptions.push({label:w.getShippingLabel(t.data.free_shipping[s]),value:s,diff:e,selected:"",tax:0}));if(!1===w.isEmpty(t.data.shipping)){for(var o in t.data.shipping)for(var n in t.data.shipping[o])-1===_.indexOf(a,n)&&(i&&(t.data.shipping_prev.cost=0),!1!==(e=w.getShippingDifference(t.data.shipping[o][n],t.data.shipping_prev))&&w.shippingOptions.push({label:w.getShippingLabel(t.data.shipping[o][n]),value:n,diff:e,selected:"",override:i}));w.ShippingRaw.push(t.data.shipping)}0<w.shippingOptions.length&&(void 0!==w.globalVars.parent_selected_shipping&&!1!==w.globalVars.parent_selected_shipping&&!1!==w.globalVars.parent_shipping_method?!1===w.isEmpty(t.data.free_shipping)&&g(w.shippingOptions).each(function(t,e){w.globalVars.parent_shipping_method===e.label?(w.shippingOptions[t].selected="checked",w.setShipping(parseFloat(w.shippingOptions[t].diff.cost)),w.setShippingTax(parseFloat(w.shippingOptions[t].diff.tax))):(w.shippingOptions[0].selected="checked",w.setShipping(parseFloat(w.shippingOptions[0].diff.cost)),w.setShippingTax(parseFloat(w.shippingOptions[0].diff.tax)))}):(w.shippingOptions[0].selected="checked",w.setShipping(parseFloat(w.shippingOptions[0].diff.cost)),w.setShippingTax(parseFloat(w.shippingOptions[0].diff.tax)))),!w.doShow()&&"hold"===w.sendStatus?w.sendBucket():w.render()}else w.render();w.ShippingCall=null}}):w.render()},getShippingLabel:function(t){return t.label},getShippingDifference:function(t,e,i){void 0===i&&(i=!0);var a=parseFloat(t.cost)+parseFloat(t.shipping_tax),s=parseFloat(e.cost)+parseFloat(e.tax),a=this.unformatPrices(a-parseFloat(s)),s=this.PreCalculateTotalForShipping(a);if(i&&s<=0)return!1;e=this.unformatPrices(t.shipping_tax)-this.unformatPrices(e.tax);return{cost:a-e,tax:e}},getShippingPrintDiff:function(i){var a=0;return g(this.shippingOptions).each(function(t,e){e.value===i&&(a=e.diff.cost,!1===w.globalVars.global.include_taxes&&(a+=e.diff.tax))}),a},isFloatOrNum:function(t){var e=Number(t)===t&&t%1!=0,t=Number(t)===t&&t%1==0;return e||t},isEmpty:function(t){for(var e in t)if(_.has(t,e))return!1;return!0},getDataTitle:function(t){return 0<g('select[data-attribute_name="'+t+'"]').length?g('select[data-attribute_name="'+t+'"]').parent("td").eq(0).attr("data-attribute-title"):t},doShow:function(){return this.globalVars.offer_data.is_show_confirmation},render:function(){var t=g(".wfocu-cart-components"),e=window.wp.template("wfocu-bucket-template");t.html(e({Bucket:w})).promise().done(function(){w.HasEventRunning=!1,w.reveal(),w.bindsidecartHandlers(),g(document).trigger("wfocuBucketConfirmationRendered",[w])})},sum:function(t){return t.reduce(function(t,e){return t+e},0)},PreCalculateTotalForShipping:function(t){var e=this.sum(this.getItemsPrices()),i=this.getTaxTotal();return parseFloat(e)+i+parseFloat(t)},getTaxTotal:function(){var t=this.sum(this.itemsTaxes),e=this.shippingTax;return parseFloat(t)+e},getTotal:function(){return parseFloat(this.sum(this.getItemsPrices()))+this.getTaxTotal()+this.shippingCost},reveal:function(){jQuery("body").addClass("wfocu-sidecart-open")},hide:function(){jQuery("body").hasClass("wfocu-sidecart-open")&&(jQuery("body").removeClass("wfocu-sidecart-open"),jQuery(".wfocu-offer-btn-wrap").removeClass("wfocu-def-hide")),0===w.getItems().length&&jQuery(".wfocu-offer-btn-wrap").addClass("wfocu-def-hide")},initiateLoader:function(){jQuery(".wfocu-sidebar-cart .wfocu-cart-components").addClass("wfocu-loading"),jQuery(".wfocu-sidebar-cart .wfocu-mc-close").addClass("wfocu-disable-close")},clearLoader:function(){jQuery(".wfocu-sidebar-cart .wfocu-cart-components").removeClass("wfocu-loading"),jQuery(".wfocu-sidebar-cart .wfocu-mc-close").removeClass("wfocu-disable-close")},init:function(){this.placeOverlay(),!0!==this.globalVars.is_preview&&(this.prepareActionLinks(),this.bindAdvanceHandlers(),this.bindOneTimeHandlers(),this.bindAcceptButton(".wfocu_upsell"),this.shippingPreference=this.globalVars.offer_data.shipping_preferece,this.bindsidecartHandlers(),this.hideOutOfStockLinks(),w.updateViews(),g(document).trigger("wfocuBucketCreated",[this]))},bindAdvanceHandlers:function(){var t=this;jQuery(document).on("elementor/popup/show",function(){0<g('.elementor[data-elementor-type="popup"] .wfocu_upsell').length&&t.bindAcceptButton('.elementor[data-elementor-type="popup"] .wfocu_upsell')})},bindOneTimeHandlers:function(){g(document).on("click",".wfocu-black-overlay",function(){!1===g(".wfocu-sidebar-cart .wfocu-cart-components").hasClass("wfocu-loading")&&w.hide()}),g("body").on("click",".wfocu-confirm-order-btn",function(){return w.render(),!1}),g("body").on("click",".wfocu_skip_offer",function(){w.skip(this)})},bindAcceptButton:function(t){g(t).on("click",function(){if(!0!==w.HasEventRunning){w.HasEventRunning=!0;var t=w.globalVars.offer_data.is_show_confirmation,e=g(this).data("key"),i=[],a=w.getPriceByKey(e),s=!1,o="",n=g('.wfocu-select-qty-input[data-key="'+e+'"]').val();if(void 0===n&&(n=1),"complete"===document.readyState){if(0<g('form.wfocu_variation_selector_form[data-key="'+g(this).data("key")+'"]').length){if(g(this).hasClass("disabled")){var r=g('form.wfocu_variation_selector_form[data-key="'+g(this).data("key")+'"]').eq(0);return g("html, body").stop().animate({scrollTop:r.offset().top-100},1e3,"swing",function(){}),alert(w.globalVars.messages.i18n_no_matching_variations_text),w.HasEventRunning=!1}o=g('form.wfocu_variation_selector_form[data-key="'+g(this).data("key")+'"] input[name="_wfocu_variation"]').val();var c=g('form.wfocu_variation_selector_form[data-key="'+g(this).data("key")+'"]').eq(0).serialize(),r=g('form.wfocu_variation_selector_form[data-key="'+g(this).data("key")+'"] .wfocu_variation_selector_wrap').attr("data-prices");(r=JSON.parse(r))[o]&&(a=r[o].price_excl_tax,s=r[o].price_incl_tax-r[o].price_excl_tax);var p,l=wfocuCommons.wfab_deparam1(c);for(p in l)i.push(p+"="+l[p])}if(0<g('form.wfocu_attributes_selector_form[data-key="'+g(this).data("key")+'"]').length){if(g(this).hasClass("disabled")){var f=g('form.wfocu_attributes_selector_form[data-key="'+g(this).data("key")+'"]').eq(0);return g("html, body").stop().animate({scrollTop:f.offset().top-100},1e3,"swing",function(){}),alert(w.globalVars.messages.i18n_no_matching_variations_text),w.HasEventRunning=!1}i=""!==(i=g('form.wfocu_attributes_selector_form[data-key="'+g(this).data("key")+'"]').eq(0).serialize())?i.split("&"):[]}if(g(this).hasClass("disabled"))return w.HasEventRunning=!1;f=w.validateBeforeAddItem(e,i,o),a=wfocuCommons.applyFilters("wfocu_additem_price",a,e,o),s=wfocuCommons.applyFilters("wfocu_additem_taxes",s,e,o),i=wfocuCommons.applyFilters("wfocu_additem_data",i,e,o);return!1===f?(alert(w.globalVars.messages.maybe_no_product_selected),w.HasEventRunning=!1):!1===t?(w.clean(),w.addItem(e,a,i,s,n),void w.sendBucket()):(w.addItem(e,a,i,s,n),w.render(),!1)}w.HasEventRunning=!1}})},bindsidecartHandlers:function(){g(".wfocu_remove_item").click(function(){var t=g(this).attr("data-index");"number"==typeof parseInt(t)&&(w.removeItem(t),w.render())}),g(".wfocu-mc-close a").on("click",function(){w.hide()}),g(".wfocu-mc-button").click(function(){try{w.sendBucket()}catch(t){console.log(t)}}),g('.wfocu_ship_selector input[type="radio"]').change(function(){var t,e=g(this).val();for(t in w.shippingOptions)e===w.shippingOptions[t].value?(w.shippingOptions[t].selected="checked",w.setShipping(parseFloat(w.shippingOptions[t].diff.cost)),w.setShippingTax(parseFloat(w.shippingOptions[t].diff.tax))):w.shippingOptions[t].selected="";w.render()}),g(".wfocu_skip_offer_mc").click(function(){w.skip(this)}),g("select.wfocu-select-qty-input").on("change",function(){var t=g(this),e=t.attr("data-key");g('.wfocu-select-qty-input[data-key="'+e+'"]').val(t.val())})},updateViews:function(){if(!0!==this.ViewsRegistered&&"1"!==this.localStorage.get("wfocu_"+this.globalVars.offer+"_"+this.globalVars.session_id)){var t,e={};for(t in this.globalVars.offer_data.products)e[t]={id:this.globalVars.offer_data.products[t].id,name:this.globalVars.offer_data.products[t].name};g.post(this.globalVars.wc_ajax_url.toString().replace("%%endpoint%%","wfocu_front_register_views"),{action:"wfocu_front_register_views","wfocu-si":this.globalVars.session_id,nonce:this.globalVars.nonces.wfocu_register_views,data:{offer_type:this.globalVars.offer_type,offer_type_index:this.globalVars.offer_type_index,products:e}},function(){w.localStorage.set("wfocu_"+w.globalVars.offer+"_"+w.globalVars.session_id,"1")}),this.ViewsRegistered=!0}},getChosenShipping:function(){if(0===this.shippingOptions.length)return null;var i=null;return g(this.shippingOptions).each(function(t,e){"checked"===e.selected&&(i=e)}),i},HandleResponse:function(t){var e=1e3;Object.prototype.hasOwnProperty.call(t,"success")&&!0===t.success?w.swal.show({html:this.successMessage}):Object.prototype.hasOwnProperty.call(t,"success")&&"onhold"===t.success?wfocuSweetalert2.getContent().querySelector("#wfocuswal-content #wfocu-swal-content").textContent=t.message:(e=1500,w.swal.show({html:this.warningMessage})),setTimeout(function(){void 0!==t.data&&void 0!==t.data.redirect_url?window.location=t.data.redirect_url:window.location=wfocu_vars.order_received_url},e)},ShowLoading:function(){this.swal.show(this.getLoader())},getLoader:function(){return'<img src="'+this.globalVars.loader+'" height="56" width="56" style="margin-top:12px;" />'},skip:function(t){try{g(t).prop("disable",!0),g(t).prop("disabled",!0),w.swal.show(this.getLoader()),g.ajax({type:"POST",url:this.globalVars.wc_ajax_url.toString().replace("%%endpoint%%","wfocu_front_offer_skipped"),data:{action:"wfocu_front_offer_skipped",nonce:this.globalVars.nonces.wfocu_front_offer_skipped,data:{offer_type:this.globalVars.offer_type,offer_type_index:this.globalVars.offer_type_index},"wfocu-si":this.globalVars.session_id},success:function(t){_.has(t,"success")&&(window.location=t.data.redirect_url)},error:function(t){void 0!==window.wfocu_vars.order_received_url&&(window.location=window.wfocu_vars.order_received_url+"&ec="+t.status)}})}catch(t){g.ajax({type:"POST",url:this.globalVars.wc_ajax_url.toString().replace("%%endpoint%%","wfocu_front_catch_error"),data:{action:"wfocu_front_catch_error",nonce:this.globalVars.nonces.wfocu_front_catch_error,message:t,"wfocu-si":this.globalVars.session_id}}),void 0!==w.globalVars.order_received_url&&(window.location=w.globalVars.order_received_url+"&ec="+t)}},getBucketSendData:function(){return wfocuCommons.applyFilters("wfocu_front_charge_data",{action:"wfocu_front_charge",nonce:this.globalVars.nonces.wfocu_charge,"wfocu-si":this.globalVars.session_id,items:this.getItems(),itemsData:this.getItemsData(),itemQty:this.itemQty,shipping:this.getChosenShipping(),totals:{itemsPrices:this.unformatPrices(this.getItemsPrices()),taxTotal:this.unformatPrices(this.getTaxTotal()),total:this.unformatPrices(this.getTotal())}})},sendBucket:function(){try{0===this.getItems().length&&this.handleSendBucketException("no items in the bucket");var t=this.getBucketSendData();if(!1===wfocuSweetalert2.isVisible()&&w.swal.show({html:this.getLoader()+'<div id="wfocu-swal-content" style="margin:10px 0 24px;color:#353030;font-size:18px;line-height:28px;font-weight:500;">'+this.globalVars.loading_text+"</div>",width:360}),0<w.getItemsNeedDynamicShipping().length&&!1===w.doShow()&&!1===w.sendStatus)return w.sendStatus="hold",void(w.HasEventRunning=!1);if(g(document).trigger("wfocu_external",[w,t]),!0===w.inOfferTransaction)return;if(!0===w.isSending)return void(w.HasEventRunning=!1);w.isSending=!0,g.ajax({type:"POST",url:this.globalVars.wc_ajax_url.toString().replace("%%endpoint%%","wfocu_front_charge"),data:t,dataType:"json",success:function(t){var e=1e3;w.HasEventRunning=!1,w.isSending=!1,_.has(t,"success")?(e=1e3,!0===t.success?w.swal.show({html:w.successMessage}):"onhold"===t.success?wfocuSweetalert2.getContent().querySelector("#wfocuswal-content #wfocu-swal-content").textContent=t.message:(e=1500,w.swal.show({html:w.warningMessage}))):_.has(t,"result")&&"error"===t.result?(e=1500,w.swal.show({html:w.warningMessage})):void 0!==window.wfocu_vars.order_received_url&&(window.location=window.wfocu_vars.order_received_url),setTimeout(function(){void 0!==t.data&&void 0!==t.data.redirect_url?window.location=t.data.redirect_url:window.location=window.wfocu_vars.order_received_url},e)},error:function(t){w.HasEventRunning=!1,w.isSending=!1,void 0!==window.wfocu_vars.order_received_url&&(t=t.status,window.location=w.globalVars.order_received_url+"&ec="+t)}})}catch(t){this.handleSendBucketException(t)}},handleSendBucketException:function(t){g.ajax({type:"POST",url:this.globalVars.wc_ajax_url.toString().replace("%%endpoint%%","wfocu_front_catch_error"),data:{action:"wfocu_front_catch_error",nonce:this.globalVars.nonces.wfocu_front_catch_error,message:t,"wfocu-si":this.globalVars.session_id}}),void 0!==w.globalVars.order_received_url&&(window.location=w.globalVars.order_received_url+"&ec="+t)},setShipping:function(t){this.shippingCost=t},setShippingTax:function(t){this.shippingTax=t},getShipping:function(){return this.shippingCost},getKeyBYIndex:function(t){var e=_.allKeys(wfocu_vars.offer_data.fields);return _.isUndefined(e[t-1])?t:e[t-1]},convertLinksYes:function(t,e){var i=t.attr("href").substring(1);w.isValidKey(i)||(""===i&&(i=1),i=this.getKeyBYIndex(i)),w.isValidKey(i)&&(t.attr("href","javascript:void(0);"),t.attr("data-key",i),t.addClass("wfocu_upsell"),!1===w.globalVars.offer_data.settings.ask_confirmation&&t.addClass("wfocu_paypal_in_context_btn"),t.removeClass("wfocu_yes_btn"),g(e).removeClass("wfocu_yes_btn"))},convertLinksNo:function(t,e){t.attr("href","javascript:void(0);"),t.addClass("wfocu_skip_offer"),t.removeClass("wfocu_no_btn"),g(e).removeClass("wfocu_no_btn")},prepareActionLinks:function(){g('a[href*="wfocu-accept-link=yes"]').each(function(t,e){g(this).addClass("wfocu_yes_btn");var i=g(this).attr("href"),i=wfocuCommons.parseURL(i);_.isObject(i)&&_.has(i,"searchObject")&&_.isObject(i.searchObject)&&_.has(i.searchObject,"key")?g(this).attr("href","#"+i.searchObject.key):g(this).attr("href","")}),g('a[href*="wfocu-reject-link=yes"]').each(function(t,e){g(this).addClass("wfocu_no_btn"),g(this).attr("href","")}),g(".wfocu_yes_btn").each(function(t,e){var i,a=e;"A"===e.tagName?(i=g(e),w.convertLinksYes(i,a)):0<g(e).find("a").length&&g(e).find("a").each(function(t,e){e=g(e);0<e.length&&w.convertLinksYes(e,a)})}),g(".wfocu_no_btn").each(function(t,e){var i,a=e;"A"===e.tagName?(i=g(e),w.convertLinksNo(i,a)):0<g(e).find("a").length&&g(e).find("a").each(function(t,e){e=g(e);0<e.length&&w.convertLinksNo(e,a)})}),g(document).trigger("wfocuBucketLinksConverted",[w])},isValidKey:function(t){return void 0!==this.globalVars.offer_data.products[t]},placeOverlay:function(){var t;0===g(".wfocu-offer-btn-wrap").length&&0<g("#tmpl-wfocu-body-next-template").length&&(t=window.wp.template("wfocu-body-next-template"),g("body").prepend(t({})))},getPriceByKey:function(t){return void 0===this.globalVars.offer_data.products[t]||void 0===this.globalVars.offer_data.products[t].price?0:this.globalVars.offer_data.products[t].sale_price_excl_tax},hideOutOfStockLinks:function(){for(var t in this.globalVars.offer_data.products)_.has(this.globalVars.offer_data.products[t],"is_in_stock")&&(this.globalVars.offer_data.products[t].is_purchasable&&this.globalVars.offer_data.products[t].is_in_stock||w.DisableButtonState(t),!1===this.globalVars.offer_data.products[t].backorders_allowed&&-1!==this.globalVars.offer_data.products[t].max_qty&&this.globalVars.offer_data.products[t].max_qty<parseInt(this.globalVars.offer_data.products[t].quantity)&&w.DisableButtonState(t))},formatMoney:function(t){return accounting.formatMoney(t,{symbol:wfocu_wc_params.currency_format_symbol,decimal:wfocu_wc_params.currency_format_decimal_sep,thousand:wfocu_wc_params.currency_format_thousand_sep,precision:wfocu_wc_params.currency_format_num_decimals,format:wfocu_wc_params.currency_format})},formatPrice:function(t,e,i,a){return void 0===e&&(e=wfocu_wc_params.currency_format_num_decimals),void 0===i&&(i=wfocu_wc_params.currency_format_thousand_sep),void 0===a&&(a=wfocu_wc_params.currency_format_decimal_sep),parseFloat(accounting.formatNumber(t,e,i,a))},unformatPrices:function(t){if("object"!==_typeof(t))return accounting.unformat(t);var e,i=[];for(e in t)i.push(accounting.unformat(t[e]));return i},expire:function(){g.post(this.globalVars.wc_ajax_url.toString().replace("%%endpoint%%","wfocu_front_offer_expired"),{action:"wfocu_front_offer_expired",nonce:this.globalVars.nonces.wfocu_offer_expired,"wfocu-si":this.globalVars.session_id},function(t){_.has(t,"success")&&(window.location=t.data.redirect_url)})},swal:{current:null,show:function(t){wfocuSweetalert2.isVisible()&&wfocuSweetalert2.close();var e={showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1};"string"==typeof t?wfocuSweetalert2(g.extend(e,{html:t})):wfocuSweetalert2(g.extend(e,t))},hide:function(){wfocuSweetalert2.close()}},localStorage:{get:function(t){try{return localStorage.getItem(t)}catch(t){return!1}},set:function(t,e){try{return localStorage.setItem(t,e),!0}catch(t){return!1}}}};w.init();var m={snapshots:{},allOptions:{},anyAttributes:{},chosenVariations:{},shippingCharges:{},ShippingCallVariation:null,handlersAttached:[],OptionsHtml:{},init:function(){g(".wfocu_variation_selector_wrap").each(function(){var t=g(this).attr("data-key"),e=g(this).attr("data-variations"),i=g(this).attr("data-default");try{e=JSON.parse(e),m.snapshots[t]=defiant.getSnapshot(e),m.getAllAttributesNames(t),m.populateDropDowns(t);var a=m.query(t,'//*[@d:name="'+i+'"]');m.setUpDefault(t,a),-1===m.handlersAttached.indexOf(t)&&(m.attachHandlers(t),m.handlersAttached.push(t))}catch(t){console.error(t)}})},getAllAttributesNames:function(e){void 0===m.allOptions[e]&&(this.allOptions[e]={},m.OptionsHtml[e]={},g('.wfocu_variation_selector_wrap[data-key="'+e+'"] select').each(function(){var t=g(this).attr("name");m.allOptions[e][t]={},m.OptionsHtml[e][t]={},g(this).find("option").each(function(){m.OptionsHtml[e][t][g(this).attr("value")]=this,m.allOptions[e][t][g(this).attr("value")]=this.innerText})}))},getDropDownValues:function(t){var e=[];return g(t).find("option").each(function(){e.push(g(this).val())}),e},populateDropDowns:function(a){this.anyAttributes[a]=[],g('.wfocu_variation_selector_wrap[data-key="'+a+'"] select').each(function(){var t=g(this).attr("name"),e=m.query(a,"//@"+t);""===e[0]&&m.anyAttributes[a].push(t);var i=m.getDropDownValues(this),i=m.createOptions(e,t,a,i);i&&g(this).html(i.innerHTML)})},setUpDefault:function(e,i){g('.wfocu_variation_selector_wrap[data-key="'+e+'"] select').each(function(){var t=g(this).attr("name");m.isAttributeAny(e,t)||(t=i[0]["@"+t],!0===window.wfocu_vars.show_variation_default&&g(this).val(t).prop(t))});var t,a,s=w.globalVars.offer_data.products[e].variations_data.default,o=g('.wfocu_variation_selector_wrap[data-key="'+e+'"]').attr("data-shipping-hash"),n=JSON.parse(o),r=_.has(n,s)?n[s]:"",c=[];for(t in n)r===n[t]&&c.push(t);if(0<g(".shop_attributes td.product_weight").length&&(a=g('.wfocu_variation_selector_wrap[data-key="'+e+'"]').attr("data-weight-html"),a=JSON.parse(a),g(".shop_attributes td.product_weight").html(a[s])),0<g(".shop_attributes td.product_dimensions").length&&(a=g('.wfocu_variation_selector_wrap[data-key="'+e+'"]').attr("data-dimensions"),a=JSON.parse(a),g(".shop_attributes td.product_dimensions").html(a[s])),!0===w.globalVars.offer_data.products[e].needs_shipping&&_.has(w.globalVars.offer_data.products[e],"shipping"))if(w.isEmpty(w.globalVars.offer_data.products[e].shipping.shipping)&&w.isEmpty(w.globalVars.offer_data.products[e].shipping.free_shipping))for(var p in c)m.shippingCharges[c[p]]={cost:0,tax:0,method:"",label:""};else if(!1===w.isEmpty(w.globalVars.offer_data.products[e].shipping.shipping))for(var l in w.globalVars.offer_data.products[e].shipping.shipping){var f=w.getShippingDifference(w.globalVars.offer_data.products[e].shipping.shipping[l],w.globalVars.offer_data.products[e].shipping.shipping_prev,!1);if(!1!==f)for(var h in c)m.shippingCharges[c[h]]={cost:f.cost,tax:f.tax,method:l,label:w.globalVars.offer_data.products[e].shipping.shipping[l].label}}else if(!1===w.isEmpty(w.globalVars.offer_data.products[e].shipping.free_shipping))for(var u in w.globalVars.offer_data.products[e].shipping.free_shipping)for(var d in c)m.shippingCharges[c[d]]={cost:0,tax:0,method:u,label:w.globalVars.offer_data.products[e].shipping.free_shipping[u].label};g(document).trigger("wfocu_variation_selected",[e,s])},getOptionName:function(t,e,i){return void 0===m.allOptions[t]||void 0===m.allOptions[t][e]||void 0===m.allOptions[t][e][i]?"":m.allOptions[t][e][i]},unique:function(t){return t.filter(function(t,e,i){return e===i.indexOf(t)})},createOptions:function(t,e,i,a){if(this.isAttributeAny(i,e))return g('.wfocu_variation_selector_wrap[data-key="'+i+'"] select[name="'+e+'"] option[value=""]').remove(),g('.wfocu_variation_selector_wrap[data-key="'+i+'"] select[name="'+e+'"]').get(0).selectedIndex=0,"";var s=this.unique(t);s.sort(function(t,e){return _.indexOf(a,t)<_.indexOf(a,e)?-1:_.indexOf(a,t)>_.indexOf(a,e)?1:0});var o,n=document.createElement("select");for(o in!0!==window.wfocu_vars.show_variation_default&&((t=document.createElement("option")).value="-1",t.innerText=window.wfocu_vars.no_variation_text,n.appendChild(t)),s){var r=m.OptionsHtml[i][e][s[o]];n.appendChild(r)}return n},isAttributeAny:function(t,e){return void 0!==m.anyAttributes[t]&&-1<m.anyAttributes[t].indexOf(e)},query:function(t,e){t=this.getSnapShot(t);return defiant.json.search(t,e)},getSnapShot:function(t){if(this.snapshots&&_.has(this.snapshots,t))return this.snapshots[t]},preparePrices:function(t,e){_.has(m.shippingCharges,e)||w.globalVars.offer_data.shipping_preferece,this.populatePrices(t,e)},populatePrices:function(t,e){var i,a,s=g('form.wfocu_variation_selector_form[data-key="'+t+'"] .wfocu_variation_selector_wrap').attr("data-prices"),o=0;(s=JSON.parse(s))[e]&&(o=s[e]);var n=o.price_incl_tax_raw,r=o.regular_price_incl_tax_raw;!1===window.wfocu_vars.is_show_price_with_tax&&(n=o.price_excl_tax_raw,r=o.regular_price_excl_tax),i=void 0!==m.shippingCharges[e]?m.shippingCharges[e].cost+m.shippingCharges[e].tax+n:n;o=(a=void 0!==m.shippingCharges[e]?m.shippingCharges[e].cost+m.shippingCharges[e].tax+r:r)-i,n=w.formatPrice((a-i)/a*100,0);g("span.wfocu_variable_price_sale[data-key='"+t+"']").html(w.formatMoney(i)).show();r=window.wfocu_vars.offer_data.products[t].quantity;i!==a?(g("span.wfocu_variable_price_regular[data-key='"+t+"']").html(w.formatMoney(a)),g("span.wfocu_variable_price_regular[data-key='"+t+"']").show()):(g("span.wfocu_variable_price_regular[data-key='"+t+"']").html(w.formatMoney(a)),g("span.wfocu_variable_price_regular[data-key='"+t+"']").not(".wfocu_tags").hide()),g("span.wfocu_variable_price_regular.wfocu_tags[data-key='"+t+"']").html(w.formatMoney(a)),g("span.wfocu_variable_price_save_value[data-key='"+t+"']").html(w.formatMoney(o)),g("span.wfocu_variable_price_save_percentage[data-key='"+t+"']").html(n+"%"),g("span.wfocu_variable_price_save_percentage_combo[data-key='"+t+"']").html(t+w.formatMoney(o)+" ("+n+"%)"),g("span.wfocu_single_unit_price[data-key='"+t+"']").html(w.formatMoney(i/parseInt(r))),g(document).trigger("wfocu_populatePrices",[i,a,t,s,e,w])},attachHandlers:function(t){g('.wfocu_variation_selector_wrap[data-key="'+t+'"] select').each(function(){g(this).on("change",function(){var t=g(this).parents(".wfocu_variation_selector_wrap").eq(0).attr("data-key"),e=g('.wfocu_variation_selector_wrap[data-key="'+t+'"]').find('select[name="'+g(this).attr("name")+'"]').not(g(this));0<e.length&&e.val(g(this).val()),m.processVariationSelection(t)})})},processVariationSelection:function(i){var t,e,a=[];g('.wfocu_variation_selector_wrap[data-key="'+i+'"]:first select').each(function(){var t=g(this).val(),e=g(this).attr("name");m.isAttributeAny(i,e)||a.push("@"+e+"='"+t.replace(/'/g,"\\'")+"'")}),a&&0<a.length&&((t=this.query(i,"//*["+a.join(" and ")+"]"))&&0<t.length?(this.chosenVariations[i]={},this.chosenVariations[i]=t[0].id,g('.wfocu_variation_selector_wrap[data-key="'+i+'"] input[name="_wfocu_variation"]').val(this.chosenVariations[i]),m.preparePrices(i,this.chosenVariations[i]),g(document).trigger("wfocu_variation_selected",[i,this.chosenVariations[i]]),0<g(".shop_attributes td.product_weight").length&&(e=g('.wfocu_variation_selector_wrap[data-key="'+i+'"]').attr("data-weight-html"),e=JSON.parse(e),g(".shop_attributes td.product_weight").html(e[this.chosenVariations[i]])),0<g(".shop_attributes td.product_dimensions").length&&(e=g('.wfocu_variation_selector_wrap[data-key="'+i+'"]').attr("data-dimensions"),e=JSON.parse(e),g(".shop_attributes td.product_dimensions").html(e[this.chosenVariations[i]])),w.EnableButtonState(i)):(w.DisableButtonState(i),g('.wfocu_variation_selector_wrap[data-key="'+i+'"] input[name="_wfocu_variation"]').val("")))}};g(document).ready(function(){m.init()})}(jQuery);