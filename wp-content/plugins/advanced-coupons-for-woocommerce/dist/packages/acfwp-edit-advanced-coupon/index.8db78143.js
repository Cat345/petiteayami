function Qi(){import.meta.url,import("_").catch(()=>1);async function*t(){}}function A(t,e=""){e||(e="show");let o=e==="show"?"block":"none";jQuery(t).css("display",o)}function g(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039"};return t.replace(/[&<>"']/g,o=>e[o])}function Ht(){const{decimal_separator:t}=acfw_edit_coupon,e=jQuery(this);let o=e.val()+"";o=="0"+t&&e.val("0"),!(o=="0"||o.substring(0,2)=="0"+t)&&(o=o.replace(/^0+/,""),o=o.substring(0,1)==t?"0"+o:o,e.val(o))}function jt(t,e,o="value",i="label"){return t.map(n=>'<option value="'.concat(n[o],'" ').concat(n[o]==e?"selected":"",">").concat(n[i],"</option>")).toString().replace(/>,</g,"><")}function _(t,e){return t==e?"selected":""}function oe(t="",e=!1){const{currency_symbol:o,discount_field_options:i}=acfw_edit_coupon,{nodiscount:n,override:c,percent:a,fixed:s}=i,l='<option value="nodiscount" '.concat(_(t,"nodiscount"),">= : ").concat(n,"</option>");return"\n    ".concat(e?l:"",'\n    <option value="override" ').concat(_(t,"override"),">").concat(o," : ").concat(c,'</option>\n    <option value="percent" ').concat(_(t,"percent"),">% : ").concat(a,'</option>\n    <option value="fixed" ').concat(_(t,"fixed"),">-").concat(o," : ").concat(s,"</option>\n  ")}function V(t=""){const{exactly:e,anyexcept:o,morethan:i,lessthan:n}=acfw_edit_coupon.condition_field_options;return'\n    <option value="=" '.concat(_(t,"="),">").concat(e,'</option>\n    <option value="!=" ').concat(_(t,"!="),">").concat(o,'</option>\n    <option value=">" ').concat(_(t,">"),">").concat(i,'</option>\n    <option value="<" ').concat(_(t,"<"),">").concat(n,"</option>\n  ")}function ie(t=""){const{exists:e,notexist:o}=acfw_edit_coupon.condition_exists_field_option;return'\n    <option value="exists" '.concat(_(t,"exists"),">").concat(e,'</option>\n    <option value="notexist" ').concat(_(t,"notexist"),">").concat(o,"</option>\n  ")}function ne(t=""){const{contains:e}=acfw_edit_coupon.condition_contains_field_option;return'\n    <option value="contains" '.concat(_(t,"contains"),">").concat(e,"</option>\n  ")}function X(t){const{decimal_separator:e}=acfw_edit_coupon,o=parseFloat(t.replace(e,"."));return isNaN(o)?0:o}const Nt=jQuery,{cart_weight:Y}=acfw_edit_coupon.cart_condition_fields;function ce(){Y.default_data_value={},Y.template_callback=ae,Y.scraper_callback=se}function ae(t){const{condition:e,value:o}=t,{title:i,desc:n,field:c}=Y,{condition_label:a}=acfw_edit_coupon;return'\n    <div class="cart-weight-field condition-field" data-type="cart-weight">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(i,"</h3>\n        <label>").concat(n,'</label>\n        <div class="field-control">\n            <label>').concat(a,'</label>\n            <select class="condition-select">\n                ').concat(V(e),'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>').concat(c,'</label>\n            <input class="condition-value wc_input_decimal" type="text" value="').concat(o>=0?o:"",'">\n        </div>\n    </div>\n    ')}function se(t){return{condition:Nt(t).find(".condition-select").val(),value:Nt(t).find(".condition-value").val()}}function Ut(t){const{product_id:e,product_label:o,condition_label:i,quantity:n}=t;return'\n    <tr>\n        <td class="product" data-product="'.concat(g(JSON.stringify(t)),'" data-product_id="').concat(e,'">\n            ').concat(o,'\n        </td>\n        <td class="condition">').concat(i,'</td>\n        <td class="quantity">').concat(n,'</td>\n        <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n        </td>\n    </tr>\n    ')}function Kt(t=4){const{no_products_added:e}=acfw_edit_coupon;return'\n    <tr class="no-result">\n        <td colspan="'.concat(t,'">').concat(e,"</td>\n    </tr>\n    ")}const le=jQuery,{product_quantity:tt}=acfw_edit_coupon.cart_condition_fields;function de(){tt.default_data_value={},tt.template_callback=re,tt.scraper_callback=ue}function re(t){const{add_product_label:e}=acfw_edit_coupon,{title:o,product_col:i,condition_col:n,quantity_col:c}=tt;let a="";const s=[];if(t.length)for(let l of t)s.push(l.product_id),a+=Ut(l);else a=Kt(4);return'\n    <div class="product-quantity-condition-field condition-set"  data-type="product-quantity">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(o,'</h3>\n        <table class="product-quantity-condition-table acfw-styled-table" data-exclude="').concat(JSON.stringify(s),'">\n            <thead>\n                <tr>\n                    <th class="product">').concat(i,'</th>\n                    <th class="condition">').concat(n,'</th>\n                    <th class="quantity">').concat(c,'</th>\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>\n                ').concat(a,'\n            </tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="4">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            ').concat(e,"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n    </div>\n    ")}function ue(t){const e=t.querySelectorAll(".product-quantity-condition-table tr td.product"),o=[];return e.forEach(i=>o.push(le(i).data("product"))),o}const pe=jQuery,{customer_registration_date:qt}=acfw_edit_coupon.cart_condition_fields;function _e(){qt.template_callback=fe,qt.scraper_callback=be}function fe(t){const{title:e,desc:o,hours:i}=qt;return'\n    <div class="customer-registration-date-field condition-field" data-type="customer-registration-date">\n\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(e,"</h3>\n\n        <label>").concat(o,'</label>   \n        <div class="field-control side-label">\n            <input class="condition-value" type="number" min="1" value="').concat(t&&t>-1?t:0,'">\n            <label>').concat(i,"</label>\n        </div>\n    </div>\n    ")}function be(t){return parseInt(pe(t).find(".condition-value").val())}const he=jQuery,{customer_last_ordered:St}=acfw_edit_coupon.cart_condition_fields;function ve(){St.template_callback=$e,St.scraper_callback=me}function $e(t){const{title:e,desc:o,hours:i}=St;return'\n    <div class="customer-last-ordered-field condition-field" data-type="customer-last-ordered">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(e,"</h3>\n        <label>").concat(o,'</label>    \n        <div class="field-control side-label">\n            <input class="condition-value" type="number" min="0" value="').concat(t&&t>-1?t:0,'">\n            <label>').concat(i,"</label>\n        </div>\n    </div>\n    ")}function me(t){return parseInt(he(t).find(".condition-value").val())}const vt=jQuery,{total_customer_spend:et}=acfw_edit_coupon.cart_condition_fields;function ye(){et.default_data_value={},et.template_callback=ge,et.scraper_callback=we}function ge(t){const{condition:e,value:o,offset:i}=t,{condition_label:n}=acfw_edit_coupon,{title:c,desc:a,total_spend:s,days_offset:l}=et,d=o?X(o):0;return'\n    <div class="total-customer-spend-field condition-field" data-type="total-customer-spend">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(c,"</h3>\n        <label>").concat(a,'</label>\n        <div class="field-control">\n            <label>').concat(n,'</label>\n            <select class="condition-select">\n                ').concat(V(e),'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>').concat(s,'</label>\n            <input class="condition-value wc_input_price" type="text" min="0" value="').concat(!isNaN(d)&&d>-1?o:0,'">\n        </div>\n        <div class="field-control">\n            <label>').concat(l,'</label>\n            <input class="condition-offset" type="number" min="0" value="').concat(i&&i>-1?i:0,'">\n        </div>\n    </div>\n    ')}function we(t){return{condition:vt(t).find(".condition-select").val(),value:vt(t).find(".condition-value").val(),offset:vt(t).find(".condition-offset").val()}}class xe{table_placeholder_row_template(e=4){const{no_products_added:o}=acfw_edit_coupon;return' \n            <tr class="no-result">\n                <td colspan="'.concat(e,'">').concat(o,"</td>\n            </tr>\n        ")}table_markup(){const{add_product_label:e}=acfw_edit_coupon,{tableproduct:o}=acfw_psaeic,{products:i}=o,{label:n}=i;return'\n            <table class="product-stock-availability-exists-in-cart-table acfw-styled-table">\n                <thead>\n                    <tr>\n                        <th class="product">'.concat(n.columns.product,'</th>\n                        <th class="condition">').concat(n.columns.condition,'</th>\n                        <th class="quantity">').concat(n.columns.quantity,'</th>\n                        <th class="actions"></th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ').concat((()=>{let c="";if(i&&i.data&&i.data.length)for(let a of i.data)o.row.data=a,c+=o.row.template_view_row();else c=o.template.table_placeholder_row_template(4);return c})(),'\n                </tbody>\n                <tfoot>\n                    <tr>\n                        <td colspan="4">\n                            <a class="psaeic-btn-add-category-row" href="javascript:void(0);" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_add_category(event)">\n                                <i class="dashicons dashicons-plus"></i>\n                                ').concat(e,"\n                            </a>\n                        </td>\n                    </tr>\n                </tfoot>\n            </table>\n        ")}}const B=jQuery;class ke{trigger_btn_add_category(e){const{tableproduct:o}=acfw_psaeic,i=e.currentTarget;o.row.element.$button=B(i),o.row.data=o.row.data_initial(),o.row.add()}trigger_btn_action_add(e){const{tableproduct:o}=acfw_psaeic,i=e.currentTarget;o.row.element.$button=B(i),o.row.view()}trigger_btn_action_edit(e){const{tableproduct:o}=acfw_psaeic,i=e.currentTarget;o.row.element.$button=B(i),o.row.edit()}trigger_btn_action_cancel(e){const{tableproduct:o}=acfw_psaeic,i=e.currentTarget;o.row.element.$button=B(i),o.row.cancel()}trigger_btn_action_remove(e){const{tableproduct:o}=acfw_psaeic,i=e.currentTarget;o.row.element.$button=B(i),o.row.detect(),o.row.remove()}}const x=jQuery;class je{constructor(){this._element={$button:x(null),$table:x(this),$tbody:x(this),$row:x(this),$product:x(this),$condition:x(this),$quantity:x(this),colspan:4,data:[]},this._data=this.data_initial()}get element(){return this._element}set element(e){this._element=e}get data(){return this._data}data_initial(){return{product:{id:0,label:""},condition:{id:"",label:""},quantity:0}}set data(e){this._data=e}template_initiate_select2(){this._element.$tbody.find("select.wc-product-search").trigger("change"),x("body").trigger("wc-enhanced-select-init")}template_add_edit_row(){var s,l;const{tableproduct:e}=acfw_psaeic,{products:o}=e,{edit:i,add:n,cancel:c}=acfw_edit_coupon.product_table_buttons,{type_to_search:a}=acfw_edit_coupon.bogo_form_fields;return'\n            <tr class="add-edit-form adding">\n                <td class="product" data-product="'.concat(typeof this._data=="object"?g(JSON.stringify(this._data)):0,'">\n                    <div class="object-search-wrap">\n                        <select class="psaeic-select-product wc-product-search" data-placeholder="').concat(a,'" data-action="acfwp_add_products_search">\n                            ').concat(typeof this._data=="object"&&this._data.product.id?'<option value="'.concat(this._data.product.id,'" selected>').concat(this._data.product.label,"</option>"):"",'\n                        </select>                        \n                    </div>\n                </td>\n                <td class="condition">                \n                    <select class="condition-select psaeic-select-condition">\n                        ').concat(Object.keys(o.options.conditions).map(d=>{let r=o.options.conditions[d],u=typeof this._data=="object"&&this._data.condition.id==d?"selected":"";return'<option value="'.concat(d,'" ').concat(u,">").concat(r,"</option>")}).join(""),"\n                          ").concat(V((l=(s=this._data)==null?void 0:s.condition)==null?void 0:l.id),'\n                    </select> \n                </td>\n                <td class="quantity">\n                  <input disabled="true" type="number" class="condition-quantity" value="').concat(typeof this._data=="object"?this._data.quantity:0,'" min="0">\n                </td>\n                <td class="actions">\n                    <button type="button" class="button-primary psaeic-btn-add" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_add(event)">').concat(typeof this._data=="object"&&this._data.product.id?i:n,'</button>\n                    <button type="button" class="button psaeic-btn-cancel" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_cancel(event)">').concat(c,"</button>\n                </td>\n            </tr>\n        ")}template_view_row(){return'\n            <tr>\n                <td class="product product-'.concat(this._data.product.id,' object" data-product="').concat(g(JSON.stringify(this._data)),'">\n                    ').concat(this._data.product.label,'\n                </td>\n                <td class="condition">').concat(this._data.condition.label,'</td>\n                <td class="quantity">').concat(["instock","outofstock","onbackorder"].includes(this._data.condition.id)?"-":this._data.quantity!==void 0?this._data.quantity:"-",'</td>\n                <td class="actions">\n                    <a class="psaeic-btn-edit" href="javascript:void(0)" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_edit(event)"><span class="dashicons dashicons-edit"></span></a>\n                    <a class="psaeic-btn-remove" href="javascript:void(0)" onclick="acfw_psaeic.tableproduct.trigger.trigger_btn_action_remove(event)"><span class="dashicons dashicons-no"></span></a>\n                </td>\n            </tr>\n        ')}detect(){this._element.$button&&(this._element.$row=this._element.$button.closest("tr"),this._element.$table=this._element.$button.closest(".acfw-styled-table"),this._element.$tbody=this._element.$table.find("tbody"),this._element.$product=this._element.$row.find(".psaeic-select-product"),this._element.$condition=this._element.$row.find(".psaeic-select-condition"),this._element.$quantity=this._element.$row.find(".condition-quantity"),this._element.colspan=this._element.$row.find("td").length,this._element.data=this._element.$row.find("td.product").data("product"))}read(){var n,c,a,s,l,d,r,u;const{$product:e,$condition:o,$quantity:i}=this._element;this._data={product:{id:parseInt((c=(n=e==null?void 0:e.val())==null?void 0:n.toString())!=null?c:""),label:(l=(s=(a=x(e))==null?void 0:a.select2("data")[0])==null?void 0:s.text.replace("\n","").replace(/\s+/g," ").trim())!=null?l:""},condition:{id:(r=(d=o==null?void 0:o.val())==null?void 0:d.toString())!=null?r:"",label:o.find("option:selected").text().replace("\n","").replace(/\s+/g," ").trim()},quantity:parseInt(((u=i==null?void 0:i.val())!=null?u:"0").toString())}}validate(e=!0){const{tableproduct:o}=acfw_psaeic,{fill_form_propery_error_msg:i}=acfw_edit_coupon,{$product:n,$condition:c}=this._element,{product:a}=this._data;return!n.val()||!c.val()?(vex.dialog.alert(i),!1):(this._element.$table.find("td.product.object").each(function(){if(x(this).data("product").product.id==a.id)return vex.dialog.alert(o.products.exists),!1}),e)}add(){this.detect(),!(this._data.product.id&&!this.validate())&&(this._element.$tbody.find("tr.no-result").remove(),this._element.$tbody.append(this.template_add_edit_row()),this.template_initiate_select2())}edit(){this.detect(),this._data=this._element.data,this._element.$row.replaceWith(this.template_add_edit_row()),this.template_initiate_select2();const e=x(".condition-quantity");["instock","outofstock","onbackorder"].includes(this._data.condition.id)?e.prop("disabled",!0):e.prop("disabled",!1)}view(e={}){this.template_initiate_select2(),this.detect(),Object.keys(e).length||this.read(),this.validate()&&this._element.$row.replaceWith(this.template_view_row())}cancel(){this.detect(),this.remove()}remove(){const{tableproduct:e}=acfw_psaeic;this._element.$row.remove(),this._element.$tbody.find("tr").length<=0&&this._element.$tbody.html(e.template.table_placeholder_row_template(this._element.colspan))}}class qe{constructor(){this._products={},this._trigger={},this._template={},this._row={}}get products(){return this._products}set products(e){this._products=e}get template(){return this._template}get trigger(){return this._trigger}get row(){return this._row}build(){this._row=new je,this._template=new xe,this._trigger=new ke,this.save()}save(){window.acfw_psaeic={...acfw_edit_coupon.cart_condition_fields.acfw_product_stock_availability_exists_in_cart,tableproduct:this}}}const Ot=jQuery,{product_stock_availability_exists_in_cart:ot}=acfw_edit_coupon.cart_condition_fields;function Se(){ot.default_data_value={},ot.template_callback=Qe,ot.scraper_callback=ze,Ot("#acfw_cart_conditions").on("change",".product-stock-availability-exists-in-cart-field .condition-select",Oe)}function Qe(t={}){const{title:e,products:o}=ot;o.data=t.products;const i=new qe;return i.products=o,i.build(),'\n        <div class="product-stock-availability-exists-in-cart-field condition-set" data-type="product-stock-availability-exists-in-cart">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(e,"</h3>\n            \n            ").concat(i.template.table_markup(),"\n        </div>\n    ")}function ze(t){const e=t.querySelectorAll(".product-stock-availability-exists-in-cart-table tr td.product"),o=[];return e.forEach(i=>o.push(Ot(i).data("product"))),{products:o}}function Oe(){const t=Ot(this),o=t.closest("tr").find(".condition-quantity"),i=o.closest(".field-control");["instock","outofstock","onbackorder"].includes(t.val())?(o.prop("disabled",!0),o.val(0)):(o.prop("disabled",!1),i.show())}const $t=jQuery,{has_ordered_before:mt}=acfw_edit_coupon.cart_condition_fields;function Ce(){mt.default_data_value={},mt.template_callback=Fe,mt.scraper_callback=Te}function Fe(t={}){const{condition:e,value:o,products:i}=t,{cart_condition_fields:n,add_product_label:c}=acfw_edit_coupon,{product_col:a,condition_col:s,quantity_col:l}=n.product_quantity,{title:d,type:r,within_a_period:u,number_of_orders:S,num_prev_days:Q}=n.has_ordered_before,z=[];let w="";if(i&&i.length)for(let O of i)z.push(O.product_id),w+=Ut(O);else w=Kt(4);return'\n    <div class="cart-quantity-field condition-field condition-set" data-type="has-ordered-before">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'.concat(d,'</h3>\n        <div class="field-control">\n            <label>').concat(r,'</label>\n            <select class="condition-select has-ordered-before-type">\n                <option value="within-a-period" ').concat(_(e,"within-a-period"),">").concat(u,'</option>\n                <option value="number-of-orders" ').concat(_(e,"number-of-orders"),">").concat(S,'</option>\n            </select>\n        </div>\n        <div class="field-control condition-type-value">\n            <label>').concat(Q,'</label>\n            <input class="condition-value" type="number" min="0" value="').concat(o,'">\n        </div>\n        <table class="has-ordered-before-products-table acfw-styled-table" data-exclude="').concat(JSON.stringify(z),'">\n            <thead>\n                <tr>\n                    <th class="product">').concat(a,'</th>\n                    <th class="condition">').concat(s,'</th>\n                    <th class="quantity">').concat(l,'</th>\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>\n                ').concat(w,'\n            </tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="4">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            ').concat(c,"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n    </div>\n    ")}function Te(t){const e=t.querySelectorAll(".has-ordered-before-products-table tr td.product"),o=[];return e.forEach(i=>o.push($t(i).data("product"))),{condition:$t(t).find(".condition-select").val(),value:parseInt($t(t).find(".condition-value").val()),products:o}}const F=jQuery,{has_ordered_product_categories_before:yt}=acfw_edit_coupon.cart_condition_fields;function Ie(){yt.default_data_value={},yt.template_callback=Ae,yt.scraper_callback=De,Ne()}function Ne(){const t=document.querySelector("#acfw_cart_conditions");F(t).on("change","select.hopcb-select-type-condition",function(){const{within_a_period_label:e,number_of_orders_label:o}=acfw_edit_coupon,i=F(this),n=i.closest(".has-ordered-product-categories-before-field"),c=n.find(".hopcb-condition-type-value label");i.val()==="within-a-period"?c.text(e):c.text(o)})}function Ae(t={}){const{condition:e,quantity:o}=t,{condition_label:i,cart_condition_fields:{cart_quantity:{field:n},has_ordered_product_categories_before:{title:c,type:a,within_a_period:s,number_of_orders:l,num_prev_days:d,categories:r},product_category:{placeholder:u}},condition_field_options:{exactly:S,anyexcept:Q,morethan:z,lessthan:w}}=acfw_edit_coupon;let O=t.type&&t.type.label?t.type.label:s,ft=[{value:"within-a-period",label:s},{value:"number-of-orders",label:l}],bt=[{value:"=",label:S},{value:"!=",label:Q},{value:">",label:z},{value:"<",label:w}];return'\n        <div class="has-ordered-product-categories-before-field condition-field condition-set" data-type="has-ordered-product-categories-before">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(c,'</h3>\n            \n            <div class="field-control">\n                <label>').concat(a,'</label>\n                <select class="hopcb-select-type-condition">                    \n                    ').concat(ft.map(v=>{let $=t.type?t.type.condition:"within-a-period";const{value:m,label:R}=v;return'<option value="'.concat(m,'" ').concat(_($,m),">").concat(R,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control hopcb-condition-type-value">\n                <label>').concat(O,'</label>\n                <input class="hopcb-select-type-value" type="number" min="0" value="').concat(t.type&&t.type.value?t.type.value:0,'">\n            </div>\n            <div class="field-control categories">\n                <label></label>\n                <select class="hopcb-select-categories wc-enhanced-select" multiple data-placeholder="').concat(u,'">\n                    ').concat(Object.keys(r.options).map(v=>{let $=r.options[v];const m=t.categories&&t.categories.indexOf(parseInt(v))>=0?"selected":"";return'<option value="'.concat(v,'" ').concat(m,">").concat($,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(i,'</label>\n                <select class="hopcb-select-condition">\n                    ').concat(bt.map(v=>{const{value:$,label:m}=v;let ht=(t.condition?t.condition:">")===$?"selected":"";return'<option value="'.concat($,'" ').concat(ht,">").concat(m,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(n,'</label>\n                <input type="number" class="hopcb-select-quantity" value="').concat(o,'" min="').concat(e=="<"?1:0,'">\n            </div>\n            \n        </div>\n    ')}function Xt(t){if(t==null||typeof t=="string"&&t.trim()===""||Array.isArray(t)&&t.length===0)return!1;if(typeof t=="object"){for(const e in t)if(!Xt(t[e]))return!1}return!0}function De(t){t.querySelectorAll(".has-ordered-product-categories-before-table tr td.category");let e={categories:F(t).find(".hopcb-select-categories").val(),condition:F(t).find(".hopcb-select-condition").val(),quantity:F(t).find(".hopcb-select-quantity").val(),type:{condition:F(t).find(".hopcb-select-type-condition").val(),label:F(t).find(".hopcb-select-type-condition option:selected").text(),value:F(t).find(".hopcb-select-type-value").val()}};return Xt(e)?e:!1}const T=jQuery,{total_customer_spend_on_product_category:gt}=acfw_edit_coupon.cart_condition_fields;function Ee(){gt.default_data_value={},gt.template_callback=Me,gt.scraper_callback=Pe,Je()}function Je(){const t=document.querySelector("#acfw_cart_conditions");T(t).on("change","select.tcspc-select-type-condition",function(){const{within_a_period_label:e,number_of_orders_label:o}=acfw_edit_coupon,i=T(this),n=i.closest(".total-customer-spend-on-product-category-field"),c=n.find(".tcspc-condition-type-value label");i.val()==="within-a-period"?c.text(e):c.text(o)})}function Me(t={}){const{condition:e,spend:o}=t,{condition_label:i,cart_condition_fields:{total_customer_spend:{total_spend:n},total_customer_spend_on_product_category:{title:c,type:a,within_a_period:s,number_of_orders:l,num_prev_days:d,categories:r},product_category:{placeholder:u}},condition_field_options:{exactly:S,anyexcept:Q,morethan:z,lessthan:w}}=acfw_edit_coupon;let O=t.type&&t.type.label?t.type.label:s,ft=[{value:"within-a-period",label:s},{value:"number-of-orders",label:l}],bt=[{value:"=",label:S},{value:"!=",label:Q},{value:">",label:z},{value:"<",label:w}];return'\n        <div class="total-customer-spend-on-product-category-field condition-field condition-set" data-type="total-customer-spend-on-product-category">\n            <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n            <h3 class="condition-field-title">'.concat(c,'</h3>\n            \n            <div class="field-control">\n                <label>').concat(a,'</label>\n                <select class="tcspc-select-type-condition">                    \n                    ').concat(ft.map(v=>{let $=t.type?t.type.condition:"within-a-period";const{value:m,label:R}=v;return'<option value="'.concat(m,'" ').concat(_($,m),">").concat(R,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control tcspc-condition-type-value">\n                <label>').concat(O,'</label>\n                <input class="tcspc-select-type-value" type="number" min="0" value="').concat(t.type&&t.type.value?t.type.value:0,'">\n            </div>\n            <div class="field-control categories">\n                <label></label>\n                <select class="tcspc-select-categories wc-enhanced-select" multiple data-placeholder="').concat(u,'">\n                    ').concat(Object.keys(r.options).map(v=>{let $=r.options[v];const m=t.categories&&t.categories.indexOf(parseInt(v))>=0?"selected":"";return'<option value="'.concat(v,'" ').concat(m,">").concat($,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(i,'</label>\n                <select class="tcspc-select-condition">\n                    ').concat(bt.map(v=>{const{value:$,label:m}=v;let ht=(t.condition?t.condition:">")===$?"selected":"";return'<option value="'.concat($,'" ').concat(ht,">").concat(m,"</option>")}).join(""),'\n                </select>\n            </div>\n            <div class="field-control">\n                <label>').concat(n,'</label>\n                <input type="text" class="tcspc-select-spend wc_input_decimal" value="').concat(o!=null?o:0,'">\n            </div>\n            \n        </div>\n    ')}function Zt(t){if(t==null||typeof t=="string"&&t.trim()===""||Array.isArray(t)&&t.length===0)return!1;if(typeof t=="object"){for(const e in t)if(!Zt(t[e]))return!1}return!0}function Pe(t){let e={categories:T(t).find(".tcspc-select-categories").val(),condition:T(t).find(".tcspc-select-condition").val(),spend:T(t).find(".tcspc-select-spend").val(),type:{condition:T(t).find(".tcspc-select-type-condition").val(),label:T(t).find(".tcspc-select-type-condition option:selected").text(),value:T(t).find(".tcspc-select-type-value").val()}};return Zt(e)?e:!1}const At=jQuery,{shipping_zone_region:it}=acfw_edit_coupon.cart_condition_fields;function We(){it.default_data_value={},it.template_callback=Le,it.scraper_callback=Ve}function Le(t){const{value:e}=t,{title:o,zone_label:i,zone_placeholder:n,regions_label:c,regions_placeholder:a,zone_options:s}=it,l=e&&e.length?e:[];return'\n    <div class="shipping-zone-region-field condition-field" data-type="shipping-zone-region"\n        data-zones="'.concat(g(JSON.stringify(s)),'"\n        data-regions="').concat(g(JSON.stringify(l)),'">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">').concat(o,'</h3>\n        <div class="field-control">\n            <label>').concat(i,'</label>\n            <select class="condition-select wc-enhanced-select" data-placeholder="').concat(g(n),'">\n                <option value="">').concat(n,"</option>\n                ").concat(Re(t,s),'\n            </select>\n        </div>\n        <div class="field-control regions">\n            <label>').concat(c,'</label>\n            <select class="condition-value wc-enhanced-select" multiple data-placeholder="').concat(g(a),'">\n            </select>\n        </div>\n    </div>\n    ')}function Ve(t){return{condition:At(t).find(".condition-select").val(),value:At(t).find(".condition-value").val()}}function Re(t,e){const{condition:o}=t;let i="";for(let n in e){const c=e[n];i+='\n            <option value="'.concat(n,'" ').concat(_(o,n),">\n                ").concat(c.name,"\n            </option>\n        ")}return i}const Z=jQuery,{custom_taxonomy:H}=acfw_edit_coupon.cart_condition_fields,{cart_condition_fields:Be,condition_field_options:He}=acfw_edit_coupon;function Ue(){H.default_data_value={},H.template_callback=Ke,H.scraper_callback=Xe}function Ke(t){const{condition:e,value:o,qtyCondition:i,quantity:n}=t,{title:c,select_taxonomy:a,product_type:s,select_terms:l}=H,{field:d}=Be.cart_quantity,{condition_label:r}=acfw_edit_coupon,{exactly:u,anyexcept:S,morethan:Q,lessthan:z}=He,w=i||">",O=o&&o.length?o:[];return'\n    <div class="custom-taxonomy-field condition-field" data-type="custom-taxonomy" \n      data-selected_terms="'.concat(g(JSON.stringify(O)),'">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">').concat(c,'</h3>\n      <div class="field-control">\n        <select class="condition-select wc-enhanced-select custom-taxonomy" data-placeholder="').concat(a,'">\n          <option value="">').concat(a,"</option>\n          ").concat(Ze(e),'\n        </select>\n      </div>\n      <div class="field-control field-control-wide">\n        <select class="condition-value wc-enhanced-select" multiple data-placeholder="').concat(l,'">\n        </select>\n      </div>\n      <div class="field-control condition">\n            <label>').concat(r,'</label>\n            <select class="condition-select qty-condition-select">\n                <option value="=" ').concat(w=="="?"selected":"",">").concat(u,'</option>\n                <option value="!=" ').concat(w=="!="?"selected":"",">").concat(S,'</option>\n                <option value=">" ').concat(w==">"?"selected":"",">").concat(Q,'</option>\n                <option value="<" ').concat(w=="<"?"selected":"",">").concat(z,'</option>\n            </select>\n        </div>\n        <div class="field-control quantity">\n            <label>').concat(d,'</label>\n            <input type="number" class="condition-quantity" value="').concat(typeof n=="number"?n:0,'" min="').concat(i=="<"?1:0,'">\n        </div>\n    </div>\n    ')}function Xe(t){return{condition:Z(t).find(".condition-select").val(),value:Z(t).find(".condition-value").val(),qtyCondition:Z(t).find(".qty-condition-select").val(),quantity:Z(t).find(".condition-quantity").val()}}function Ze(t){const{tax_options:e,product_type:o}=H;let i="";for(let n of e){const{name:c,label:a}=n;i+='\n      <option value="'.concat(c,'" ').concat(_(t,c),">\n        ").concat(a,"\n      </option>\n    ")}return i}const G=jQuery,{cart_condition_fields:Ct}=acfw_edit_coupon,{custom_user_meta:wt,custom_cart_item_meta:xt}=Ct;function Ge(){wt.default_data_value={},wt.template_callback=Dt,wt.scraper_callback=Et,xt.default_data_value={},xt.template_callback=Dt,xt.scraper_callback=Et}function Dt(t,e){const{condition:o,key:i,value:n,type:c}=t,{condition_label:a}=acfw_edit_coupon,{title:s,meta_key:l,meta_value:d,value_type:r}=Ct[e],u=e.replace(/_/g,"-");return'\n    <div class="'.concat(u,'-field condition-field" data-type="').concat(u,'">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">').concat(s,'</h3>\n      <div class="field-control wider">\n        <label>').concat(r,'</label>\n        <select class="value-type">\n          ').concat(Ye(c,e),'\n        </select>\n      </div>\n      <div class="field-control">\n        <label>').concat(a,'</label>\n        <select class="condition-select">\n          ').concat(V(o),"\n          ").concat(ie(o),"\n          ").concat(ne(o),'\n        </select>\n      </div>\n      <div class="field-control wider">\n        <label>').concat(l,'</label>\n        <input class="condition-key" type="text" value="').concat(i||"",'">\n      </div>\n      <div class="field-control wider">\n        <label>').concat(d,'</label>\n        <input class="condition-value" type="text" value="').concat(n||n>-1?n:"",'">\n      </div>\n    </div>\n  ')}function Et(t){return{condition:G(t).find(".condition-select").val(),key:G(t).find(".condition-key").val(),value:G(t).find(".condition-value").val(),type:G(t).find(".value-type").val()}}function Ye(t,e){const{type_options:o}=Ct[e];let i="";for(let n in o){const c=o[n];i+='<option value="'.concat(n,'" ').concat(_(t,n),">").concat(c,"</option>")}return i}const kt=jQuery,{number_of_orders:nt}=acfw_edit_coupon.cart_condition_fields;function to(){nt.default_data_value={},nt.template_callback=eo,nt.scraper_callback=oo}function eo(t){const{condition:e,value:o,offset:i}=t,{condition_label:n}=acfw_edit_coupon,{title:c,desc:a,count_label:s,prev_days_label:l}=nt;return'\n    <div class="number-of-orders-field cart-quantity-field condition-field" data-type="number-of-orders">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">'.concat(c,"</h3>\n      <label>").concat(a,'</label>\n      <div class="field-control">\n        <label>').concat(n,'</label>\n        <select class="condition-select">\n            ').concat(V(e),'\n        </select>\n      </div>\n      <div class="field-control">\n          <label>').concat(s,'</label>\n          <input class="condition-value" type="number" min="0" value="').concat(o>=0?o:"",'">\n      </div>\n      <div class="field-control">\n          <label>').concat(l,'</label>\n          <input class="condition-offset" type="number" min="0" value="').concat(i>=0?i:"",'">\n      </div>\n    </div>\n  ')}function oo(t){return{condition:kt(t).find(".condition-select").val(),value:kt(t).find(".condition-value").val(),offset:kt(t).find(".condition-offset").val()}}const P=jQuery,{coupons_applied_in_cart:U}=acfw_edit_coupon.cart_condition_fields;function io(){U.default_data_value={condition:"",value:[]},U.template_callback=no,U.scraper_callback=co,P("#acfw_cart_conditions").on("change",".coupons-applied-in-cart-field .condition-select",lo)}function no(t){const{condition:e,value:o,quantity:i,options:n}=t,{condition_label:c}=acfw_edit_coupon,a=P("#post_ID").val(),s=JSON.stringify(o),{title:l,desc:d,coupons_label:r,quantity_label:u,select_coupons:S}=U;return'\n    <div class="coupons-applied-in-cart-field condition-field" data-type="coupons-applied-in-cart">\n      <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n      <h3 class="condition-field-title">'.concat(l,'</h3>\n      <p class="condition-field-desc">').concat(d,'</p>\n      <div class="field-control coupons">\n        <label>').concat(r,'</label>\n        <select multiple class="wc-product-search condition-value" \n          data-placeholder="').concat(S,'" \n          value="').concat(s,'" \n          data-action="acfw_search_coupons" \n          data-exclude="[').concat(a,']"\n          data-include="true"\n        >').concat(so(n),'</select>\n      </div>\n      <div class="field-control">\n        <label>').concat(c,'</label>\n        <select class="condition-select">\n          ').concat(ao(e),'\n        </select>\n      </div>\n      <div class="field-control">\n        <label>').concat(u,'</label>\n        <input type="number" value="').concat(i!=null?i:1,'" min="1" class="condition-quantity">\n      </div>\n    </div>\n  ')}function co(t){return{condition:P(t).find(".condition-select").val(),value:P(t).find(".condition-value").val(),quantity:P(t).find(".condition-quantity").val()}}function ao(t){const{condition_options:e}=U;let o="";for(let i in e){const n=e[i];o+='<option value="'.concat(i,'" ').concat(_(t,i),">").concat(n,"</option>")}return o}function so(t){let e="";for(let o in t){const i=t[o];e+='<option value="'.concat(o,'" selected>').concat(i,"</option>")}return e}function lo(){const t=P(this),o=t.closest(".coupons-applied-in-cart-field").find(".condition-quantity"),i=o.closest(".field-control");console.log("field",t.val()),t.val()==="atleast"?(o.prop("disabled",!1),i.show()):(o.prop("disabled",!0),i.hide())}const Jt=jQuery,{cart_total:ct}=acfw_edit_coupon.cart_condition_fields;function ro(){ct.default_data_value={},ct.template_callback=uo,ct.scraper_callback=po}function uo(t){const{condition:e,value:o,include_tax:i}=t,{title:n,desc:c,field:a,tax_label:s}=ct,{condition_label:l}=acfw_edit_coupon;return'\n    <div class="cart-total-field condition-field" data-type="cart-total">\n    <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n    <h3 class="condition-field-title">'.concat(n,"</h3>\n    <label>").concat(c,'</label>\n    <div class="field-control">\n      <label>').concat(l,'</label>\n      <select class="condition-select">\n        ').concat(V(e),'\n      </select>\n    </div>\n    <div class="field-control">\n      <label>').concat(a,'</label>\n      <input class="condition-value wc_input_price" type="text" value="').concat(o||"",'">\n    </div>\n    <div class="field-control no-label">\n      <label><input type="checkbox" class="condition-include-tax" type="checkbox" ').concat(i==="yes"?"checked":""," /> ").concat(s,"</label>\n    </div>\n    </div>\n    ")}function po(t){const e=t.querySelector("input.condition-include-tax");return{condition:Jt(t).find(".condition-select").val(),value:Jt(t).find(".condition-value").val(),include_tax:e.checked?"yes":"no"}}const W=jQuery;function _o(){const t=document.querySelector("#acfw_cart_conditions");de(),ce(),_e(),ve(),ye(),Se(),Ce(),Ie(),Ee(),We(),Ue(),Ge(),to(),io(),ro(),W(t).on("change","input.condition-value",fo),W(t).on("change","select.value-type",bo),W(t).on("change",".custom-cart-item-meta-field .condition-select, .custom-user-meta-field .condition-select",ho)}function fo(){const t=W(this);if(t.closest(".condition-field").find("select.value-type").val()==="number"){const i=parseInt(t.val()+"");t.val(isNaN(i)?"":Math.round(i))}}function bo(){const t=W(this),e=t.closest(".condition-field"),o=e.find("select.condition-select");switch(t.val()){case"string":o.find("option[value='contains']").prop("disabled",!1);break;default:o.val()==="contains"&&o.val("="),o.find("option[value='contains']").prop("disabled",!0);break}o.trigger("change")}function ho(){var i;const t=W(this),o=t.closest(".condition-field").find(".condition-value");["exists","notexist"].includes(t.val().toString())?(o.val(0),o.prop("disabled",!0),o.parent().hide()):["exists","notexist"].includes((i=t.data("prevValue"))==null?void 0:i.toString())&&(o.val(""),o.prop("disabled",!1),o.parent().show()),t.data("prevValue",t.val().toString())}const Mt=jQuery,Pt=document.querySelector("#acfw_add_products");function L(t){Mt(Pt).data("editing",t),Mt(Pt).find("#save-add-products").prop("disabled",!t)}function Gt(t=[],e=!1){const{discount_type:o,discount_value:i}=e,{edit:n,add:c,cancel:a}=acfw_edit_coupon.product_table_buttons,{type_to_search:s}=acfw_edit_coupon.bogo_form_fields,l=typeof e=="object"?vo(e):"",d=typeof e=="object"?n:c,r=i&&X(i)>=0&&o!=="nodiscount"?i:"";return'\n    <tr class="add-edit-form adding">\n        <td class="product" data-object="'.concat(typeof e=="object"?g(JSON.stringify(e)):0,'">\n            <div class="object-search-wrap">\n                <select class="product-in-cart wc-product-search"\n                    data-placeholder="').concat(s,'"\n                    data-action="acfwp_add_products_search"\n                    data-exclude="').concat(g(JSON.stringify(t)),'">').concat(l,'</select>\n            </div>\n        </td>\n        <td class="quantity">\n            <input type="number" class="condition-quantity" value="').concat(typeof e=="object"?e.quantity:1,'" min="1">\n        </td>\n        <td class="price">\n            <div>\n            <select class="discount_type">\n                ').concat(oe(o,!0),'\n            </select>\n            <input type="text" class="discount_value short wc_input_price" value="').concat(r,'">\n            </div>\n        </td>\n        <td class="actions">\n            <button type="button" class="condition-product-add button-primary">').concat(d,'</button>\n            <button type="button" class="cancel button">').concat(a,"</button>\n        </td>\n    </tr>\n    ")}function vo(t){const{product_id:e,product_label:o}=t;return'<option value="'.concat(e,'">').concat(o,"</option>")}function Ft(t){const{product_id:e,product_label:o,quantity:i,discount_type:n,discount_value:c}=t,a=n!=="nodiscount"?c:"";return'\n    <tr>\n        <td class="product product-'.concat(e,' object" data-product="').concat(g(JSON.stringify(t)),'">\n            ').concat(o,'\n        </td>\n        <td class="quantity">').concat(i,'</td>\n        <td class="price">(').concat(n,") ").concat(a,'</td>\n        <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n        </td>\n    </tr>\n    ')}function pt(t=4){const{no_products_added:e}=acfw_edit_coupon;return'\n    <tr class="no-result">\n        <td colspan="'.concat(t,'">').concat(e,"</td>\n    </tr>\n    ")}const Qt=jQuery;function $o(){const t=Qt(this),e=t.closest(".acfw-styled-table"),o=e.find("tbody"),i=e.data("exclude");o.find("tr.no-result").remove(),o.append(Gt(i)),o.find("select.discount_type").trigger("change"),o.find("select.wc-product-search").trigger("change"),Qt("body").trigger("wc-enhanced-select-init")}function mo(){const t=jQuery(this),e=t.closest("tr"),o=t.closest(".acfw-styled-table"),i=o.find("tbody"),n=e.find(".product").data("product"),{product_id:c}=n;let a=o.data("exclude");a=typeof a=="object"?a:[],a.splice(a.indexOf(c),1),i.find("tr.no-result").remove(),e.replaceWith(Gt(a,n)),i.find("select.discount_type").trigger("change"),i.find("select.wc-product-search").trigger("acfw_product_select"),o.data("exclude",a),o.find("select.wc-product-search").data("exclude",a),Qt("body").trigger("wc-enhanced-select-init")}function yo(){const{fill_form_propery_error_msg:t,product_exists_in_table:e}=acfw_edit_coupon,o=jQuery(this),i=o.closest("tr"),n=o.closest("table.acfw-styled-table"),c=i.find(".wc-product-search"),a=i.find(".condition-quantity"),s=i.find("select.discount_type").val().toString(),l=i.find("input.discount_value").val().toString();let d=n.data("exclude");const r=parseInt(i.find(".wc-product-search").val().toString()),u={product_id:r,quantity:parseInt(i.find(".condition-quantity").val().toString()),product_label:i.find(".wc-product-search option:selected").text(),discount_type:s,discount_value:l};if(!c.val()||!a.val()||a.val()<1||s!=="nodiscount"&&(isNaN(X(l))||X(l)<0)){vex.dialog.alert(t);return}if(d.includes(r)){vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);return}d=typeof d=="object"?d:[],d.push(r),i.replaceWith(Ft(u)),n.data("exclude",d),n.find(".wc-product-search").data("exclude",d),L(!0)}function go(){const t=jQuery(this),e=t.closest("tr"),o=t.closest("table"),i=e.closest("tbody"),n=e.find("td").length,c=e.find("td.product").data("object");let a=o.data("exclude");if(a.includes(c.product_id)){vex.dialog.alert(acfw_edit_coupon.product_exists_in_table);return}typeof c=="object"?(a=typeof a=="object"?a:[],a.push(c.product_id),e.replaceWith(Ft(c)),o.data("exclude",a),o.find(".wc-product-search").data("exclude",a)):(e.remove(),i.find("tr").length<=0&&i.html(pt(n)))}function wo(){const t=jQuery(this),e=t.closest("tr"),o=e.closest("table"),i=e.closest("tbody"),n=e.find("td").length,c=e.find("td.object").data("product"),a=o.data("exclude"),s=a.indexOf(parseInt(c.product_id));s!==-1&&a.splice(s,1),o.data("exclude",a),o.find(".wc-product-search").data("exclude",a),e.remove(),i.find("tr").length<=0&&i.html(pt(n)),L(!0)}const p=jQuery,{post_id:at}=woocommerce_admin_meta_boxes,q=document.querySelector("#acfw_add_products"),st=q?q.querySelector(".acfw-overlay"):null;function xo(){p("#acfw_bogo_deals").find(".acfw-styled-table tr.add-edit-form button.cancel").trigger("click");const{post_status:t}=acfw_edit_coupon,e=q.querySelectorAll("table.acfw-styled-table tbody td.object"),o=q.querySelector(".add-before-cart-condition-check-field input[type='checkbox']");let i=[],n;e.forEach(c=>{n=p(c).data("product"),n&&i.push(n)}),A(st,"show"),p.post(ajaxurl,{action:"acfw_save_add_products_data",coupon_id:at,products:i.length?i:"empty",add_before_conditions:p(o).is(":checked")?1:0,nonce:p("#acfw_add_products").data("nonce")},c=>{c.status=="success"?t!=="publish"&&(p("input[name='post_title']").val()||p("input[name='post_title']").val("coupon-"+at),p("select[name='post_status']").append(new Option("Published","publish")).val("publish"),p("#publishing-action").append('\n                    <input type="hidden" name="publish" value="Publish">\n                '),p("input#publish").click()):c.error_msg&&(vex.dialog.alert(c.error_msg),console.log(c),p(q).addClass("save-error")),p(q).find("button#clear-add-products").prop("disabled",!1),L(!1),A(st,"hide")},"json")}function ko(){const t=p(this);if(!confirm(t.data("prompt")))return;const e=q.querySelector("table.acfw-styled-table tbody");A(st,"show"),p.post(ajaxurl,{action:"acfw_clear_add_products_data",coupon_id:at,_wpnonce:t.data("nonce")},o=>{o.status=="success"?(p(e).html(pt(4)),t.prop("disabled",!0),L(!1),p("#post-status-display").text()!="Published"&&(p("input[name='post_title']").val()||p("input[name='post_title']").val("coupon-"+at),p("input#publish").click())):(o.error_msg&&vex.dialog.alert(o.error_msg),console.log(o)),A(st,"hide")},"json")}function jo(t){p(".coupon_data_tabs").find(".acfw_add_products_tab").hasClass("active")&&p(q).data("editing")&&(t.preventDefault(),p(q).find("#save-add-products").trigger("click"),setTimeout(()=>{p(q).hasClass("save-error")?p(q).removeClass("save-error"):p("form#post").submit()},1e3))}const N=jQuery,f=document.querySelector("#acfw_add_products");function qo(t=jQuery){t(f).on("click",".acfw-styled-table tfoot .add-table-row",$o),t(f).on("click",".acfw-styled-table td.actions a.edit",mo),t(f).on("click","tr.add-edit-form .actions .condition-product-add",yo),t(f).on("click","tr.add-edit-form .actions .cancel",go),t(f).on("click",".acfw-styled-table td.actions a.remove",wo),t(f).on("click","button#save-add-products",xo),t(f).on("click","button#clear-add-products",ko),t(f).on("change","select.discount_type",Qo),t(f).on("blur",".wc_input_price",Ht),t("form#post").on("submit",jo),t(f).css("min-height",t("#coupon_options ul.coupon_data_tabs").height()+10),t(f).on("click",".acfw-styled-table .actions .remove",()=>L(!0)),t(f).on("change","input[name='add_before_cart_condition']",()=>L(!0)),So(),t(document).ajaxComplete(zo),t(f).on("change","select.discount_type",Oo)}function So(){const t=N(f).data("products"),e=N(f).find(".add-products-data-table tbody");if(t.length>0){let o="";t.forEach(i=>{o+=Ft(i)}),e.html(o)}else e.html(pt(4))}function Qo(){const t=N(this);t.closest("tr").find(".discount_value").prop("disabled",t.val()==="nodiscount")}function zo(t,e){const o=e.getResponseHeader("X-Subscription-IDs");if(!o)return;let i=N(f).data("subscription_ids")||[];const n=o.split(",").map(c=>parseInt(c));N(f).data("subscription_ids",[...i,...n].filter((c,a,s)=>s.indexOf(c)===a))}function Oo(){const t=N(f).data("subscription_ids")||[];if(!t.length)return;const e=N(this),i=e.closest("tr").find("select.wc-product-search"),n=parseInt(i.val());!t.includes(n)||e.val()==="nodiscount"||(vex.dialog.alert(N(f).data("subscription_discount_error")),e.val("nodiscount"),e.trigger("change"))}var I=jQuery;function Co(){I("body").on("change","#customer_email,#acfw_auto_apply_coupon_field,#usage_limit,#usage_limit_per_user,#_acfw_enable_virtual_coupons",Fo),I("#customer_email,#acfw_auto_apply_coupon_field").trigger("change")}function Fo(){const t=I("#customer_email"),e=parseInt(I("#usage_limit").val()),o=parseInt(I("#usage_limit_per_user").val()),i=I("#acfw_auto_apply_coupon_field"),n=I("#_acfw_enable_virtual_coupons").is(":checked"),c=I("#acfw-auto-apply-coupon .auto-apply-warning");(t.val()||e||o||n)&&i.prop("checked")?c.show():c.hide()}var To=jQuery;function Io(){const t=To(this),e=t.closest("tr"),o=e.find(".select-shipping-method"),i=e.closest(".acfw-styled-table");i.data("exclude");const n=i.data("zonemethods")||[],c=n.filter(s=>s.zone_id==t.val()),a=c.length?c[0].methods:[];o.empty(),a.length&&(a.map(s=>o.append(new Option(s.label,s.value))),o.trigger("change"))}function No(t){const e=t.find(".select-shipping-zone"),o=e.find("option:first");t.removeClass("fresh"),e.val(o.prop("value")),e.trigger("change")}const Wt=jQuery,Lt=document.querySelector("#acfw_shipping_overrides");function _t(t){Wt(Lt).data("editing",t),Wt(Lt).find("#save-shipping-overrides").prop("disabled",!t)}function Tt(t){const{no_shipping_overrides_added:e}=acfw_edit_coupon;return'\n        <tr class="no-result">\n            <td colspan="'.concat(t,'">').concat(e,"</td>\n        </tr>\n    ")}const b=jQuery,D=document.querySelector("#acfw_shipping_overrides"),{post_id:zt}=woocommerce_admin_meta_boxes;function Ao(){const{post_status:t}=acfw_edit_coupon,e=D.querySelector(".acfw-overlay"),o=b(this),i=D.querySelectorAll(".shipping-overrides-table tbody tr td.object"),n=[];i.forEach(c=>{n.push(b(c).data("object"))}),A(e,"show"),o.prop("disabled",!0),b.post(ajaxurl,{action:"acfw_save_shipping_overrides",coupon_id:zt,overrides:n.length?n:"empty",nonce:b("#acfw_shipping_overrides").data("nonce")},c=>{c.status=="success"?t!=="publish"&&(b("input[name='post_title']").val()||b("input[name='post_title']").val("coupon-"+zt),b("select[name='post_status']").append(new Option("Published","publish")).val("publish"),b("#publishing-action").append('\n            <input type="hidden" name="publish" value="Publish">\n          '),b("input#publish").click()):(c.error_msg&&vex.dialog.alert(c.error_msg),console.log(c)),b(D).find("#clear-shipping-overrides").prop("disabled",!1),_t(!1),A(e,"hide")},"json")}function Do(){const t=b(this);if(!confirm(t.data("prompt")))return;const e=b(D.querySelector("table.acfw-styled-table")),o=e.find("tbody"),i=D.querySelector(".acfw-overlay");A(i,"show"),b.post(ajaxurl,{action:"acfw_clear_shipping_overrides",coupon_id:woocommerce_admin_meta_boxes.post_id,_wpnonce:t.data("nonce")},n=>{if(n.status=="success"){let c=e.find("thead tr th").length;o.html(""),o.find("tr").length<=0&&o.append(Tt(c)),e.data("exclude",[]),t.prop("disabled",!0),_t(!1),jQuery("#post-status-display").text()!="Published"&&(jQuery("input[name='post_title']").val()||jQuery("input[name='post_title']").val("coupon-"+zt),jQuery("input#publish").click())}else n.error_msg&&vex.dialog.alert(n.error_msg),console.log(n);A(i,"hide")},"json")}function Yt(t){b(D).data("editing")&&(t.preventDefault(),b(D).find("#save-shipping-overrides").trigger("click"),b("form#post").off("submit",Yt),setTimeout(()=>{b("form#post").submit()},1e3))}const Eo=jQuery,Jo=document.querySelector("#acfw_shipping_overrides");function te(t={}){const{add:e,edit:o,cancel:i}=acfw_edit_coupon.product_table_buttons,{shipping_zone:n,discount_type:c,discount_value:a}=t,l=Eo(Jo).find(".shipping-overrides-table").data("zonemethods")||[],d=l.map(Q=>({value:Q.zone_id,label:Q.zone_name})),r=a&&X(a)>=0?a:"",u=n>=0||n==="nozone"?o:e;return'\n    <tr class="add-edit-form fresh">\n      <td class="shipping-zone" data-object="'.concat(g(JSON.stringify(t)),'">\n        <div>\n          <select class="select-shipping-zone wc-enhanced-select" data-placeholder="Select shipping zone">\n            ').concat(jt(d,n),'\n          </select>\n        </div>\n      </td>\n      <td class="shipping-method">\n        <div>\n          <select class="select-shipping-method wc-enhanced-select" data-placeholder="Select shipping method">\n            ').concat(Mo(l,t),'\n          </select>\n        </div>\n      </td>\n      <td class="discount">\n        <select class="discount-type">\n          ').concat(Po(c),'\n        </select>\n        <input type="text" class="discount_value short wc_input_price" value="').concat(r,'">\n      </td>\n      <td class="actions">\n        <button type="button" class="add button-primary">').concat(u,'</button>\n        <button type="button" class="cancel button">').concat(i,"</button>\n      </td>\n    </tr>\n  ")}function Mo(t,e){const{shipping_zone:o,shipping_method:i}=e;if(o==="nozone"&&i||o>=0&&i){const n=t.filter(a=>a.zone_id==o),c=n.length?n[0].methods:[];return jt(c,i)}else{const n=t.length?t[0].methods:[];return jt(n,i)}}function Po(t=""){const{currency_symbol:e,discount_field_options:o}=acfw_edit_coupon,{override:i,percent:n,fixed:c}=o;return'\n    <option value="percent" '.concat(_(t,"percent"),">% : ").concat(n,'</option>\n    <option value="fixed" ').concat(_(t,"fixed"),">-").concat(e," : ").concat(c,'</option>\n    <option value="override" ').concat(_(t,"override"),">").concat(e," : ").concat(i,"</option>\n  ")}const Wo=jQuery,Lo=document.querySelector("#acfw_shipping_overrides");function It(t){const{shipping_zone:e,discount_type:o,discount_value:i,shipping_method:n}=t,s=(Wo(Lo).find(".shipping-overrides-table").data("zonemethods")||[]).filter(u=>u.zone_id==e);if(!s.length)return"";const{zone_name:l,methods:d}=s[0],r=d.filter(u=>u.value==n);return r.length?'\n    <tr>\n      <td class="shipping-zone object" data-object="'.concat(g(JSON.stringify(t)),'">\n        ').concat(l,'\n      </td>\n      <td class="shipping-method">\n        ').concat(r[0].label,'\n      </td>\n      <td class="discount">\n        (').concat(o,") ").concat(i,'\n      </td>\n      <td class="actions">\n        <a class="edit" href="javascript:void(0);">\n          <span class="dashicons dashicons-edit"></span>\n        </a>\n        <a class="remove" href="javascript:void(0);">\n          <span class="dashicons dashicons-no"></span>\n        </a>\n      </td>\n    </tr>\n  '):""}const lt=jQuery;function Vo(){const t=lt(this),e=t.closest(".acfw-styled-table"),o=e.find("tbody");e.data("exclude"),o.find("tr.no-result").remove(),o.append(te()),lt("body").trigger("wc-enhanced-select-init");const i=e.find("tr.add-edit-form.fresh");No(i)}function Ro(){const{fill_form_propery_error_msg:t,shipping_zone_already_added:e}=acfw_edit_coupon,o=lt(this),i=o.closest("tr"),n=i.closest(".acfw-styled-table");let c=parseInt(i.find(".select-shipping-zone").val()+""),a=i.find(".select-shipping-method").val()+"";c=c>=0&&!isNaN(c)?c:"nozone";let s=n.data("exclude");if((c<0||!a)&&!(c==="nozone"&&a)){vex.dialog.alert(t);return}if(s.filter(d=>d.zone==c&&d.method==a).length){vex.dialog.alert(e);return}const l={shipping_zone:c,shipping_method:a,discount_type:i.find(".discount-type").val(),discount_value:i.find(".discount_value").val()};i.replaceWith(It(l)),s.push({zone:c,method:a}),n.data("exclude",s),_t(!0)}function Bo(){const t=jQuery(this),e=t.closest("tr"),o=t.closest(".acfw-styled-table"),i=o.find("tbody"),n=e.find(".shipping-zone").data("object");let c=o.data("exclude")||[];c=c.filter(a=>a.zone!=n.shipping_zone||a.method!=n.shipping_method),i.find("tr.no-result").remove(),e.replaceWith(te(n)),o.data("exclude",c),lt("body").trigger("wc-enhanced-select-init")}function Ho(){const t=jQuery(this),e=t.closest("tr"),o=t.closest("table"),i=e.closest("tbody"),n=e.find("td").length,c=e.find("td.shipping-zone").data("object");let a=o.data("exclude");a=a.filter(s=>s.zone!=c.shipping_zone||s.method!=c.shipping_method),o.data("exclude",a),e.remove(),i.find("tr").length<=0&&i.append(Tt(n)),_t(!0)}function Uo(){const{shipping_zone_already_added:t}=acfw_edit_coupon,e=jQuery(this),o=e.closest("tr"),i=e.closest("table"),n=o.closest("tbody"),c=o.find("td").length,a=o.find("td.shipping-zone").data("object"),{shipping_zone:s,shipping_method:l}=a;let d=i.data("exclude");if(d.filter(r=>r.zone==s&&r.method==l).length){vex.dialog.alert(t);return}s==="nozone"&&l||s>=0&&l?(d.push({zone:s,method:s}),o.replaceWith(It(a)),i.data("exclude",d)):(o.remove(),n.find("tr").length<=0&&n.append(Tt(c)))}const y=jQuery,k=document.querySelector("#acfw_shipping_overrides");function Ko(){y(k).on("click",".acfw-styled-table tfoot .add-table-row",Vo),y(k).on("change","tr.add-edit-form .select-shipping-zone",Io),y(k).on("click","tr.add-edit-form .actions .add",Ro),y(k).on("click","tr .actions .edit",Bo),y(k).on("click","tr .actions .remove",Ho),y(k).on("click","tr.add-edit-form .actions .cancel",Uo),y(k).on("blur",".wc_input_price",Ht),y(k).on("click","#save-shipping-overrides",Ao),y(k).on("click","#clear-shipping-overrides",Do),y("form#post").on("submit",Yt),y(k).css("min-height",y("#coupon_options ul.coupon_data_tabs").height()+10),Xo()}function Xo(){const t=y(k).find(".shipping-overrides-table"),e=t.find("tbody"),o=t.data("overrides");o.length&&(e.find("tr.no-result").remove(),o.forEach(i=>{e.append(It(i))}))}const h=jQuery;function Zo(){const t=document.querySelector("#acfw_scheduler");h(t).on("change acfw_load",'.days-time-fields input[type="checkbox"]',ti),h(t).on("change acfw_load",".days-time-fields input.time-field",ei),h(t).on("change",".days-time-fields input.time-field",oi),h(t).on("change acfw_load",".acfw-scheduler-section .date-field",ii),h(t).find('.days-time-fields input[type="checkbox"], .days-time-fields input.time-field').trigger("acfw_load"),h(t).find(".acfw-scheduler-section .date-field").trigger("acfw_load"),h(".wrap").on("submit","form#post",Yo),Go()}function Go(){h(".days-time-fields input.time-field").flatpickr({allowInput:!0,enableTime:!0,noCalendar:!0,altInput:!0,altFormat:"h:i K",dateFormat:"H:i",onOpen:function(t,e,o){if(e===""){var i=new Date;i.setHours(0),i.setMinutes(0),o.setDate(i),h(".days-time-fields input.time-field").trigger("change")}}})}function Yo(t){h(".days-time-fields input.time-field").hasClass("error")&&(t.preventDefault(),vex.dialog.alert({unsafeMessage:acfw_edit_coupon.invalid_scheduler_time}),h("#publishing-action .spinner").removeClass("is-active"),h("#publishing-action #publish").removeClass("disabled"))}function ti(){const t=h(this),e=t.closest(".days-time-field");e.find(".start-time").prop("disabled",!t.is(":checked")||t.is(":disabled")),e.find(".end-time").prop("disabled",!t.is(":checked")||t.is(":disabled"))}function ei(){const t=h(this).closest(".days-time-field"),e=t.find(".start-time"),o=t.find(".end-time"),i=dt(o.val())+1,n=dt(e.val())-1,c=i?Vt(i):"",a=n?Vt(n):"";e.attr("max",c!=null?c:""),o.attr("min",a!=null?a:"")}function oi(){const t=h(this).closest(".days-time-field"),e=t.find(".start-time"),o=t.find(".end-time"),i=dt(e.val()),n=dt(o.val());i>=n?e.addClass("error"):e.removeClass("error"),n<=i?o.addClass("error"):o.removeClass("error")}function ii(){const t=h(this).closest(".options_group"),e=t.find("#_acfw_schedule_start"),o=t.find("#_acfw_schedule_expire"),i=ni(e.is(":disabled")?"":e.val(),e.is(":disabled")?"":o.val());ee().forEach(n=>{const c=h(".".concat(n,"-time-field"));i.includes(n)?c.find('input[type="checkbox"]').prop("disabled",!1).trigger("change"):(c.find('input[type="checkbox"]').prop("disabled",!0),c.find(".time-field").prop("disabled",!0))})}function dt(t){const[e,o]=t.split(":").map(i=>parseInt(i));return e*60+o}function Vt(t){const e=Math.floor(t/60),o=t-e*60;return"".concat(String(e).padStart(2,"0"),":").concat(String(o).padStart(2,"0"))}function ni(t,e){const o=ee(),i=[];if(!t||!e)return o;for(const n=new Date(t);n<=new Date(e);n.setDate(n.getDate()+1))i.push(o[n.getDay()]);return[...new Set(i)]}function ee(){return["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]}const j=jQuery,{bogo_toggle_editing_mode:Rt}=acfw_edit_coupon,{post_id:ci}=woocommerce_admin_meta_boxes;function ai(){const t=document.querySelector("#acfw_bogo_deals");j(t).on("change acfw_load","select#bogo-deals-type",si),j(t).on("change acfw_load","select#bogo-condition-type,select#bogo-deals-type",di),j(t).on("change acfw_load",".bogo-auto-add-products-field input[type='checkbox']",()=>Rt(!0)),j(t).on("change acfw_load",".bogo-discount-order-field select",()=>Rt(!0)),j(t).on("save_bogo_deals",li),j(t).find("select#bogo-deals-type").trigger("acfw_load")}function si(){const t=j(this),o=t.closest("#acfw_bogo_deals").find(".bogo-auto-add-products-field"),i=o.find("input[type='checkbox']");t.val()==="specific-products"?(i.prop("disabled",!1),o.addClass("show")):(i.prop("disabled",!1),o.removeClass("show"))}function li(){const t=j(this),e=t.find("select#bogo-deals-type"),o=t.find(".bogo-auto-add-products-field input[type='checkbox']"),i=t.find(".bogo-discount-order-field select"),n=e.val(),c={action:"acfw_save_bogo_additional_settings",coupon_id:ci,auto_add_products:o.is(":checked")?"yes":"no",discount_order:i.val(),nonce:j(".bogo-settings-field").data("nonce")};n!=="specific-products"&&delete c.auto_add_products,j.post(ajaxurl,c)}function di(){const t=j("#acfw_bogo_deals"),e=t.find("input[name='bogo_type'][value='once']"),o=t.find("input[name='bogo_type'][value='repeat']"),i=t.find("#bogo-condition-type").val(),n=t.find("#bogo-deals-type").val();t.find(".repeat-incompatible").remove(),n==="any-products"&&i!=="any-products"?(e.prop("checked",!0),o.prop("disabled",!0),o.closest(".radio-group-wrap").append('<span class="repeat-incompatible">'.concat(acfw_edit_coupon.repeat_incompatible_notice,"</span>"))):o.prop("disabled",!1)}const K=document.querySelector(".acfw-sort-coupon-priority-field"),E=jQuery;function ri(){E(K).on("change","select#_acfw_coupon_sort_select",ui),E(K).on("change","input#_acfw_coupon_sort_priority",pi),E(K).find("select#_acfw_coupon_sort_select").trigger("change")}function ui(){const t=E(this),e=E(K).find("input#_acfw_coupon_sort_priority"),o=t.val().toString();switch(o){case"0":case"1":case"10":case"30":case"50":case"90":e.hide(),e.val(o);break;case"custom":default:e.show(),e.val(E(K).data("value"))}}function pi(){const t=E(this),e=parseInt(t.val());(isNaN(e)||1>e)&&(vex.dialog.alert(acfw_edit_coupon.coupon_sort_invalid),t.val(""))}const rt=jQuery;function _i(){rt("body").on("change load_virtual_coupon","#_acfw_enable_virtual_coupons",fi),rt("#_acfw_enable_virtual_coupons").trigger("load_virtual_coupon")}function fi(t){const e=jQuery(this),o=e.closest(".inside"),i=rt("select.acfw-allowed-customers");t.type==="change"&&o.find(".save-notice").show(),e.is(":checked")?(o.removeClass("disabled"),i.prop("disabled",!0),i.closest(".options_group").hide(),Bt(!0)):(o.addClass("disabled"),i.closest(".options_group").show(),i.prop("disabled",!1),Bt(!1))}function Bt(t){var i;const e=jQuery(".form-field._acfw_coupon_url_field"),o=jQuery(".form-field._acfw_code_url_override_field");if(t){const n=(i=rt("#acfw-virtual-coupon .feature-control").data("labels"))!=null?i:{};e.find("input,button,span").hide(),e.append('<span class="vc-manage-url-coupon">'.concat(n.url_coupon_message,"</span>")),o.hide()}else e.find(".vc-manage-url-coupon").remove(),e.find("input,button,span").show(),o.show()}const ut=jQuery;function bi(){hi(),ut("body").on("change acfw_load","input#individual_use",vi),ut("input#individual_use").trigger("acfw_load")}function hi(){const t=jQuery("p.acfw-coupons-restriction-field"),e=t.closest(".options_group");t.insertAfter("p.form-field.individual_use_field"),e.remove()}function vi(){const t=ut(this),e=ut(".acfw_allowed_coupons_field"),o=e.find("select");t.is(":checked")?(o.prop("disabled",!1),e.show()):(o.prop("disabled",!0),e.hide())}const M=jQuery;function $i(){gi(),M("#woocommerce-coupon-data").on("change acfwp_load","#discount_type",mi),M("#woocommerce-coupon-data").on("change acfw_load","select#discount_type",yi),M("#discount_type").trigger("acfwp_load"),M("#_acfw_coupon_label").trigger("acfw_load")}function mi(){const t=M(this),e=t.closest(".woocommerce_options_panel").find("._acfw_percentage_discount_cap_field");t.val()==="percent"||t.val()==="acfw_percentage_cashback"?(e.addClass("show"),e.find("input").prop("disabled",!1)):(e.removeClass("show"),e.find("input").prop("disabled",!0))}function yi(){M("#_acfw_coupon_label").prop("disabled",!1)}function gi(){const t=jQuery("p.acfw-disallowed-emails-restriction-field").closest("div.options_group"),e=jQuery("p.customer_email_field").closest("div.options_group");t.length&&e.length&&t.insertAfter(e)}const J=jQuery;function wi(){J("#general_coupon_data").on("change acfw_load","#discount_type",xi),J("#general_coupon_data").on("change acfw_load","#discount_type",ki),J("#discount_type").trigger("acfw_load")}function xi(){const t=J(this),e=J("p.coupon_amount_field label"),{cashback_coupon:o}=acfw_edit_coupon;let i=e.data("default_label");switch(i||(e.data("default_label",e.text()),i=e.text()),t.val()){case"acfw_percentage_cashback":e.text(o.cashback_percentage_label);break;case"acfw_fixed_cashback":e.text(o.cashback_amount_label);break;default:e.text(i);break}}function ki(){const t=J(this),e=J("#_acfw_cashback_waiting_period");switch(t.val()){case"acfw_percentage_cashback":case"acfw_fixed_cashback":e.closest("p.form-field").show(),e.prop("disabled",!1);break;default:e.closest("p.form-field").hide(),e.prop("disabled",!0);break}}const ji=jQuery;function qi(){Si()}function Si(){const t=jQuery("p.acfw-product-attributes-restriction-field").closest("div.options_group"),e=ji('label[for="exclude_product_categories"]').closest("div.options_group");t.insertAfter(e);const o=jQuery("p.acfw-exclude-product-attributes-restriction-field"),i=o.closest(".options_group");o.insertAfter("p.form-field.acfw_product_attributes_field"),i.remove()}const{modules:C}=acfw_edit_coupon;jQuery(document).ready(t=>{C.indexOf("acfw_cart_conditions_module")>-1&&_o(),C.indexOf("acfw_add_free_products_module")>-1&&qo(),C.indexOf("acfw_auto_apply_module")>-1&&Co(),C.indexOf("acfw_shipping_overrides_module")>-1&&Ko(),C.indexOf("acfw_scheduler_module")>-1&&Zo(),C.indexOf("acfw_bogo_deals_module")>-1&&ai(),C.indexOf("acfw_sort_coupons_module")>-1&&ri(),C.indexOf("acfw_virtual_coupons_module")>-1&&_i(),bi(),$i(),wi(),qi()});export{Qi as __vite_legacy_guard};
